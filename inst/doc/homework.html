<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zhao js" />

<meta name="date" content="2021-12-17" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Zhao js</h4>
<h4 class="date">2021-12-17</h4>



<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="using-inverse-transform-method." class="section level3">
<h3>3.4: Using inverse transform method.</h3>
<p>Because I can’t find a command distribution which has density function <span class="math inline">\(g(x)\)</span> such that there is a constant <span class="math inline">\(c\)</span> satisfy <span class="math inline">\(f(x) \le cg(x)\)</span>, I don’t use acceptance-rejection method.</p>
<p>I use inverse transform method to solve the problem.</p>
<p><span class="math display">\[F(x) = P(X \le x) = \int_{-\infty}^x f(t)dt = \int_0^x \frac{t}{\sigma^2} e^{-t^2/(2\sigma^2)} dt
= \int_0^x -e^{-t^2/(2\sigma^2)} d(-t^2/(2\sigma^2))=(-e^t)|_0^{-x^2/(2\sigma^2)}=1-e^{-x^2/(2\sigma^2)}
\]</span> The inverse function is <span class="math inline">\(F^{-1}(x) = \left( -2\sigma^2 \log(1-x) \right)^{\frac{1}{2}}\)</span>.</p>
<p>The algorithm generating random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>, .<span class="dv">001</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.5</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>, .<span class="dv">001</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>, .<span class="dv">001</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As can be seen from the above three graphs, the mode of the generated samples is close to the theoretical mode.</p>
<p><br />
### 3.11: Generate a random sample of size 1000 from a normal location mixture.</p>
<p>The code to generate a random sample of size 1000 from <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distribution with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span> is as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.75</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.75</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.8</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.8</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.5</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.3</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.35</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.35</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.35</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From above figures with various <span class="math inline">\(p_1\)</span>, I find that when <span class="math inline">\(p_1&gt;0.75\)</span> or <span class="math inline">\(p_1&lt;0.35\)</span> it doesn’t produce bimodal mixtures. Therefore I conjecture when <span class="math inline">\(0.35 \le p_1 \le 0.75\)</span> it produce bimodal mixtures.</p>
<p><br />
### 3.20: Write a program to simulate a compound Poisson<span class="math inline">\((\lambda)\)</span> –Gamma process (Y has a Gamma distribution) Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = λtE[Y_1^2 ]\)</span>.</p>
<p>First, I prove that <span class="math inline">\(E[X(t)] = \lambda t E[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda t E[Y_1^2]\)</span> <span class="math inline">\(proof:\)</span></p>
<p>$$ E[X(t)]=E[_{i=1}^{N(t)}Y_i] = E[N(t)Y_1] = E{E[N(t)Y_1|N(t)]} =E{N(t)E[Y_1]} = E[N(t)]E[Y_1]=tE[Y_1]\</p>
<p>Var(X(t)) = E[X<sup>2(t)]-E</sup>2[X(t)] = E{E[X<sup>2(t)|N(t)]}-E</sup>2[X(t)]=E{Var(X(t)|N(t))+E<sup>2[X(t)|N(t)]}-E</sup>2[X(t)]\ =E{Var(<em>{i=1}<sup>{N(t)}Y_1|N(t))+E</sup>2[</em>{i=1}<sup>{N(t)}Y_1|N(t)]}-E</sup>2[X(t)] = E{N(t)Var(Y_1)}+N(t)^2 E^2[Y_1] }-E^2[X(t)]\ =E[N(t)]Var(Y_1)+E[N(t)<sup>2]E</sup>2[Y_1]-E<sup>2[N(t)]E</sup>2[Y_1]=E[N(t)]Var(Y_1)+Var(N(t))E^2[Y_1]=t Var(Y_1)+t E^2[Y_1]=t E[Y_1^2] $$</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="dv">10</span>;r <span class="ot">&lt;-</span> <span class="dv">1</span>; beta <span class="ot">&lt;-</span><span class="dv">1</span> ; lambda <span class="ot">&lt;-</span><span class="dv">1</span> ;</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t[i], r, beta)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  x_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;mean:&quot;</span>,<span class="fu">mean</span>(x_t))</span></code></pre></div>
<pre><code>## mean: 9.938876</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;variance:&quot;</span>,<span class="fu">var</span>(x_t))</span></code></pre></div>
<pre><code>## variance: 19.9803</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print(mean(x_t))</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(var(x_t))</span></span></code></pre></div>
</div>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="using-inverse-transform-method.-1" class="section level3">
<h3>3.4: Using inverse transform method.</h3>
<p>Because I can’t find a command distribution which has density function <span class="math inline">\(g(x)\)</span> such that there is a constant <span class="math inline">\(c\)</span> satisfy <span class="math inline">\(f(x) \le cg(x)\)</span>, I don’t use acceptance-rejection method.</p>
<p>I use inverse transform method to solve the problem.</p>
<p><span class="math display">\[F(x) = P(X \le x) = \int_{-\infty}^x f(t)dt = \int_0^x \frac{t}{\sigma^2} e^{-t^2/(2\sigma^2)} dt
= \int_0^x -e^{-t^2/(2\sigma^2)} d(-t^2/(2\sigma^2))=(-e^t)|_0^{-x^2/(2\sigma^2)}=1-e^{-x^2/(2\sigma^2)}
\]</span> The inverse function is <span class="math inline">\(F^{-1}(x) = \left( -2\sigma^2 \log(1-x) \right)^{\frac{1}{2}}\)</span>.</p>
<p>The algorithm generating random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution is as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>, .<span class="dv">001</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.5</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.5</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>, .<span class="dv">001</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAhFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmtttmtv+QOgCQZjqQ2/+2ZgC2Zjq2kDq2kGa22/+2/7a2///T09PbkDrbtmbb/9vb////tmb/25D/27b//7b//9v///91ydhxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJS0lEQVR4nO3da2ObNhgFYKVNslsXd1s3L2xra7aQ2vz//zdzv1jiINDlhZzzIa1dIuCpLHGRhcqZyajYGyA9BAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCGQjQJd/HtXdp5f2darK/OF/zRsBSkqPh9FrAjXJ1PvP+bdfWpDL8f5l8hfcZRtAyd3z9efrY1OFzoeHqcVdZhNAdYXp6s3r41OodcsB+veHql3RfHiaCpO8+1q9kalPvyr10+cAmyUGKFNqPlDdiZUfPM+RAnQ+3P1+VWp68qTheqj+cQSUqJ9f8stfKkBLJAWoblXSB13vdANU5XIcvvYSKUBZ1YW/PuoObW4a6TrJGwKqZc6HqnsafsTG3fz5oAfzESlAeVLurKH/Hh8oJurDS/7tqAJ09mKArrWiMHiv/9B0pxppUZnOB1OH5zxigIpOSd19MOzy5e/mZLUEyr/9ObGw08gBEhoCgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBA7oLQZWZoGGFchI1ZAxW3faqwOgXS5HJ/yetAJgXQ5H6rhJ8n9C4F0qWrQNckDgbRpWM4HRSBt0nqMV5DhkzLC4yAQAoEsBFrZSNdDWNcUESpuNlK1sVl2E0iON3AO0EmpUx0C6RbpfAoht+t3nxhAp9OGhIIDDX3kf8jszsW6ttXQi8Hi1BhI+oGG1ebhA2gMlN8AyRay27rLEXyFDRWnboGEC1luXAa+qg6B8lsg2UJhG2mlBRLdDAUGyvVAgoWCAikDkOQqFBao/KEDkisUEkjpgKSfugYFqn4OgQZ/vm0gNQmkCFT/mx7otG+g6UZk1M4YgNSegaaLU70PUY9k9IpANyQjIEWgSaDTGwdSGEi9bSANyegVgRDQWz2SVqdxb6UHEnkFn0Ag7SadDy5mBFsHJLwNKkZorp2xyASkjCTDV/KEhlu02mjvQBXRipEbq4HECQ02KCuHQa+ZO80ApOYCybv42m1Qcd+0ksmWVyETkJlkDCRNqNeLuZj4czWQuCrUAX2sfFZUn9wEpPYEtG5wnQFogmQMJE2o3pyku+C3pJtHVxS3D9TVIEfFDd60A5IlFORczApIWBUKd0VxPpAooWpjzoendviYh0baDkhWFRJYg2RVoQBApjthRiBRVah/qvFUnKpOnocVU4C/PirzbPtrgeSNZei2Ibl/Kab8TiYum5U+3z133z2cKK73ngXQ8E9RQMU+FyMQJ041yvnUK8DUUNE0u2S82TwFJGewxwCoqCETpxrFIvXXMk2MOiCbRnr4F1FA16pRzKU/+dScovak1jVoEZCYwR6D60F3z9MDoc+Hd1/LKpSZWmlXQHJGw1huQ9Z/mMOs4m6Hju8ayL44ZXWgOPyrLKDL0cupxn6ArJ4DY+rr3AFJGQ3T6+ZX3BCbOPbdEZCLJyre7FJ5CWwZkIzRMO02wG862RXXf2MZkJDhQt02oG86FYENuVMgWSercy6Ypc0V/cx0ad8lkIw79Tbb0E6PM/9UQ/f9nv0C9drxuSer1UXmhUDC2qDiQ3b/kkx09ktqUPljMZAAoV4jffecFmfzE0LN9EHz26AdARXVI0XTtzUtufG67GiPtN8QswAScHV6cKBYADkdvFDfpVgBFF3opgYlqx4c6BoofhUat0Hpume4uweKLTTsxdTaxyc7B4pehbxeMGvuA64CiiwkHih2FRqdi619tKsPoLhCzdqTehrkZePIDRfMnABFrkL12tv7OPrHddsWV79YDSTgTn211t7Vsql783OLG49BWAzUOPXqU+hUa+2dgbkY5aqGu7sWKOqN6AYIXsiwKc45UMTbiJsAijnrgEcg/D3n2UARbyP6BLInMQNFu0vWAHVdjkigeHfJvJxqeACKdpdsM0Cxrr/6A1KG3SaQJ6BIQpsCiiG0JaAo5/XegJQHoBhC/oCWkECg8EJu1ji6ZuMNKILQtmpQBKGtAQUX8gU0ezIKC6AoF2C9AS0imQZqocqfbjcc7JHj4vwChb34sUmgkBc/7NYzc5Srd6CApx1W65k7ynU43YsPoHBCNquZPUYxANApVEdms5LZo1yDAJXH76v2fVa2W4PKFfknsmyD5o1yDfURC3HYaFfyzFGui+/G2wD1pTx2+n6Og0IC1Ua+iHYB5PMDt7Cs6a9kRgAaOi3VMO7R6lJGF8w2kLBAOw6BQByfrO4vjk9W9xfHpxp1ocKynMf5yer8Qh0t42pVTn55fg1ytOKtAc04WZ1f6C6B8Mnq/EL3CeSwUAKFWYZAgVbl55fXFEqgMMtsE2hPIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBCXQJnqTWA1eKFfprqAq5sr5PX7r7pf0C9iKKa8ydleOjcVA+MQqJhBpp1FZvDCsEz5DBNdiocL6H5Bv4i+mMvx+ltp42YqBscdUHVTqJ48ZvDCsIzx5lrW3ds2lNNfxFBMNc9PPUzHVMyMuAMabNHghWGZ+hEdN8nUU7vPhnL6i5iKqRasao2hmDlxCFTW9Hq7By8My+TJj8rwSMUOSF/O4D1zMe1E/eZiYNwBVf9Z9X/Z4IVhmeJBMNdd0O1auyuGcvqLTBTT3uA0FwMTEah+S/ffagM0VUy/jY4OZP8Rq97STZpm9REzFtPdIBfxEbNvpKu3dJ00aqTzW6DbYnoz+olopK27+Wqrpz9i5v55ZHhbTH9WWhHdvP2BYrnB0420+Qiv14tpi3l97L8j4UCx+D8rD+erOQdT/bH9YJniAcraaRvLvZ8sp7+Itpi0GofSPBHMVAwMT1ZBCARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAg0oGKUWG9R1SGj3Sg5inv0SIdKM/effm47gnm6yIeKE+0X3cJFvlAmX6UXqiIB7ocf4s6a6N4oPT+v2PMSRulAxVTE6579OvKSAdKrl1871nm4SMdKHoIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRDI/536Gl2iNG+0AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>, .<span class="dv">001</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OpA6ZrY6kNtmAABmADpmOgBmZmZmkLZmtttmtv+QOgCQOjqQZgCQkGaQ2/+2ZgC2Zjq22/+2/7a2///T09PbkDrbtmbbtpDb2//b/9vb////tmb/25D/27b//7b//9v///9j8LP6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIkUlEQVR4nO2dC3vbJhSGSepkt7hd12yLt1XqtsiT/f9/4KybLV/QdxAIjuTvfZ5e7CoIvQUE6IDMngxiUmdAOxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgfoLK9ZeYp5udoPKToaAB/n42FGRn96v58DsF2Sk/fn4v7l3Qtx9Mzer99r/fu6DCGAoaoFw//HKQ8Lm1s+l0PR2PuHNB2+eX6o/8yVJ+7l5Qe/nbZ6uFOxfUminXdUFiFbtmUzfObU27xb0LKterP/f/ffrw1XbAvQva7/4w5uEnaxtNQcqgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAN0Gbx6/77bMxD28TZUcfToJqP9+9RV8vkRIXQXVc3KYOhsttQbqLw03Ql/3utY6NKx6tEWALw62KPVUButXfWIJuUq4fv9ZFqLifVtrxNl9cBuX6nLolRFrTkTB7JquhIOuplywo97yLddVrsYIuUzFuDUp93MFOpeguBDkm13isq9i9NdKS5EyvflWGwuYgNG7Z2702l2ZtgWSC2tY5m4Mhp9zlpl2DUxjLYhxBcp2fkyDVhlwy147DKmxDDZycuRK0V23IdbDaYhusDiZ31vb0S5DmHnXMElT3ekx2Kaj75ZCTiDi2QW0RGtcGtSpuCKq/dslJPNyyVa6H17RDQSazCFLbYYzZDzKZsQnSey+LLCizCVLbHYoqyFAQEJTZBbENgoJ0GtIkSKWhmPNBl0auBGnsUEcsQQYIylROMGoSpHLEoUuQwhFHPEEGtUGZyiGZMkH6hmTH/BzGoQGel9ovz0gEZYoFVZMZxjaLMSa5638RCNLXXTzPj7ejpQtqFHk8NbVenhEK0lzFmtiNKkZqfPCPXdBeKkiZoVN2qtnCxoxH+NiCBZXrEEFRtqszDoJ0GToJ+tj48Ys+tAqqf5O1QcoF+QW23Ly484fxWJAqQ21mNqcJi/C3+XacbjNyKUhXEboqQYGSO/uy6+NIBWkyFGPCzFWQqiIUY7BqjKsgRYaarJTrl+6hqU8/2ipo0MjFR2VTr3FKkIugxpKaIYdOQYqmPfpDjZdqqOq3CCOYIIVVbLN63z4/tcud/JPrfykwcvlRn6AqfKzaqhkPNYqBFYcLF1StKBwcahw63C/bH9/tKw5vXdZVzJ3so+eFhaJXxZ7K9eq9XA9UsWq/+U1delxC8EYKUmLobD7o4W33OuCnLjf1mlWnIM6lCMI073LY/bOPU4J0GHIL4uzKTffaC0ly13G/wjZImyC4zOBA3ty+7C8muCVo1F1MzbxQr5EOsZA5pCAdRah3m/d9aHiWXP+r0YI0GDrrB8mx9ZauL8mMF6SiCB3zMHiDh6nYJylODwyd72IqZj1OGQjySpiAgprf9AiaasLMT5CmEiTBccWhZf2Tw8eZCXJdcWia61yKoEMlW71vBm72zuvF/AWlN9RrpB/e8mo0bzfkvOJwaHnP7ARVxaMqFwPzQSNKkHE3cikosaGzjmJ12UMziq4rDkMISt1bvCpBm6FZe8cVh2EEpTV02Qblft3Fq9u8v6DERej8Lua9AeCloBFGLj6mHnFM+uAwhKBaUsIRxxwEJR2SXYzFfDe3m0iQgiq2aRrn3DPW/qonHURQyu5ie+bjvn8Dr+keSuX2fNByBPVmy0I+mw8mKKGhYwBV90XIKNclCYLDUJfkug8hBaUyNBdByUYcsxGUytB8BCUak3WCTjfqYIKkaw9EgpKNySYcaogWqUoFNZYSDDnmJCjJvWxWglJ0h6YTJFsHfs+Cgvaku2+jG5qdoNiG5iYoen9xboKid4cmEyTfScBJUBa7OxTmVDcmzOrBwSSC4jZEk5Sgo65pBEW9l00jqKsMEwmKaWgqQWZiQdEa68kEeRoBgjITa8u8uQrKYu0IN0mMYhRBmcIqJo1RdNuLYqygOG21yynEEWZuWy2MFxSjY+2StjhGMZ6gprHWIkhhCcomb4oc2yBZjGJUQRMrcktZGKNonHYz8RY0ab9xorGYtxE3QUdLYa/mdEWBk0siKDuWpAmuyJnhBXWJBQWtcZPMB11mVBcpBC0YCgIEHqwuj8CD1eUReKjRJqqS6QWJw6xkiYqOinyQ34/JS1C4U89KkGCw6pLoAgXhwapLoksUFDRRCgpxFAXpOijYj4VIlIJCHLVMQUuCggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAcILGnqrRJ/t9+jpY/2YEj6Ay4XnG9yczU5wQdU+MoUgx+UaPZ7dvR6SydH7g6s4E8n5ipF7I4UW1DwawlvIFPj5dbNTD9hspd6WRbDVc73NKDroFqEFia6qfm4k3OJBUjoEgvLVb0oEDb52o49QkGSr/RxKPGRLSRvU/IeLGgWRIEGYRIFb8qriL1NQIXrHO3z5Mtxi1I7uKiYNswH/IXWmtAiSNdJ7kSDxnnxga7q8DYAZtX/diJ8ZQnqblwiS7CvbqJGURiUlSNxRxBe1fZaUn+q6e3E5wweOIPxQQ9r1h4LaioES2wjrjhpBC4OCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCKBdUBWr1ntFZXy0C+re8p4M7YL2xeNfH/3eYO6HekH7jSgSeDL0CypGBacGQ72g3evPSXdtVC8oX/0riWGdDO2Cqq0J/V796ol2QU0YdMJmWrug5FAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/ASWSrTrnegeMAAAAAElFTkSuQmCC" /><!-- --> As can be seen from the above three graphs, the mode of the generated samples is close to the theoretical mode.</p>
</div>
<div id="generate-a-random-sample-of-size-1000-from-a-normal-location-mixture." class="section level3">
<h3>3.11: Generate a random sample of size 1000 from a normal location mixture.</h3>
<p>The code to generate a random sample of size 1000 from <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distribution with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span> is as follows.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.75</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2 </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.8</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.8</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.5</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.35</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.35</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.35</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From above figures with various <span class="math inline">\(p_1\)</span>, I find that when <span class="math inline">\(p_1&gt;0.75\)</span> or <span class="math inline">\(p_1&lt;0.35\)</span> it doesn’t produce bimodal mixtures. Therefore I conjecture when <span class="math inline">\(0.35 \le p_1 \le 0.75\)</span> it produce bimodal mixtures.</p>
</div>
<div id="write-a-program-to-simulate-a-compound-poissonlambda-gamma-process-y-has-a-gamma-distribution-estimate-the-mean-and-the-variance-of-x10-for-several-choices-of-the-parameters-and-compare-with-the-theoretical-values.-hint-show-that-ext-λtey_1-and-varxt-λtey_12-." class="section level3">
<h3>3.20: Write a program to simulate a compound Poisson<span class="math inline">\((\lambda)\)</span> –Gamma process (Y has a Gamma distribution) Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = λtE[Y_1^2 ]\)</span>.</h3>
<p>First, I prove that <span class="math inline">\(E[X(t)] = \lambda t E[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda t E[Y_1^2]\)</span></p>
<p><span class="math inline">\(proof:\)</span></p>
<p><span class="math display">\[\begin{align}
E[X(t)]= &amp; E[\Sigma_{i=1}^{N(t)}Y_i] = E[N(t)Y_1] = E\{E[N(t)Y_1|N(t)]\} =E\{N(t)E[Y_1]\}
= E[N(t)]E[Y_1]=\lambda tE[Y_1]\\

Var(X(t)) = &amp; E[X^2(t)]-E^2[X(t)] = E\{E[X^2(t)|N(t)]\}-E^2[X(t)]=E\{Var(X(t)|N(t))+E^2[X(t)|N(t)]\}-E^2[X(t)]\\
= &amp; E\{Var(\Sigma_{i=1}^{N(t)}Y_1|N(t))+E^2[\Sigma_{i=1}^{N(t)}Y_1|N(t)]\}-E^2[X(t)]
= E\{N(t)Var(Y_1)\}+N(t)^2 E^2[Y_1] \}-E^2[X(t)]\\
= &amp; E[N(t)]Var(Y_1)+E[N(t)^2]E^2[Y_1]-E^2[N(t)]E^2[Y_1]=E[N(t)]Var(Y_1)+Var(N(t))E^2[Y_1]\\
= &amp; \lambda t Var(Y_1)+\lambda t E^2[Y_1]=\lambda t E[Y_1^2]
\end{align}\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alpha = 1, beta = 1, lambda = 1   </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="dv">10</span>;alpha <span class="ot">&lt;-</span> <span class="dv">1</span>; beta <span class="ot">&lt;-</span><span class="dv">1</span> ; lambda <span class="ot">&lt;-</span><span class="dv">1</span> ;</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t[i], alpha, beta)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  x_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;mean:&quot;</span>,<span class="fu">mean</span>(x_t))</span></code></pre></div>
<pre><code>## mean: 10.00755</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;variance:&quot;</span>,<span class="fu">var</span>(x_t))</span></code></pre></div>
<pre><code>## variance: 20.39918</code></pre>
<p>The theoretical values of <span class="math inline">\(E[X(t)]\)</span> and <span class="math inline">\(Var(X(t))\)</span> is <span class="math inline">\(E[X(t)]=\lambda t E[Y_1]=\lambda t \alpha/\beta=\)</span> 10 , <span class="math inline">\(Var(X(t))=\lambda t E[Y_1^2]=\lambda t (\alpha^2+\alpha)/\beta^2=\)</span> 20.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alpha = 2, beta = 3, lambda = 4   </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="dv">10</span>;alpha <span class="ot">&lt;-</span> <span class="dv">2</span>; beta <span class="ot">&lt;-</span><span class="dv">3</span> ; lambda <span class="ot">&lt;-</span><span class="dv">4</span> ;</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t[i], alpha, beta)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  x_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;mean:&quot;</span>,<span class="fu">mean</span>(x_t))</span></code></pre></div>
<pre><code>## mean: 26.65885</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;variance:&quot;</span>,<span class="fu">var</span>(x_t))</span></code></pre></div>
<pre><code>## variance: 26.05153</code></pre>
<p>The theoretical values of <span class="math inline">\(E[X(t)]\)</span> and <span class="math inline">\(Var(X(t))\)</span> is <span class="math inline">\(E[X(t)]=\lambda t E[Y_1]=\lambda t \alpha/\beta=\)</span> 26.6666667 , <span class="math inline">\(Var(X(t))=\lambda t E[Y_1^2]=\lambda t (\alpha^2+\alpha)/\beta^2=\)</span> 26.6666667.</p>
<p>We can see that the estimate of the mean and the variance of X(10) for several choices of the parameters is close to the theoretical values.</p>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
</div>
<div id="write-a-function-to-compute-a-monte-carlo-estimate-of-the-beta3-3-cdf-and-use-the-function-to-estimate-fx-for-x-0.1-0.2-.-.-.-0.9.-compare-the-estimates-with-the-values-returned-by-the-pbeta-function-in-r." class="section level3">
<h3>5.4: Write a function to compute a Monte Carlo estimate of the <strong>Beta(3, 3)</strong> cdf, and use the function to estimate F(x) for x = 0.1, 0.2, . . ., 0.9. Compare the estimates with the values returned by the pbeta function in R.</h3>
<p>The density function of Beta Distribution is . The function to compute a Monte Carlo estimate of the <strong>Beta(3, 3)</strong> cdf as follows:$ x^{} (1-x)^{} $</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>MC_Beta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha=</span><span class="dv">3</span>, <span class="at">beta=</span><span class="dv">3</span>, <span class="at">n=</span><span class="dv">1000</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  thetahat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){ </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  thetahat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i]<span class="sc">*</span> (x[i]<span class="sc">*</span>u)<span class="sc">^</span>(alpha<span class="dv">-1</span>)<span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>x[i])<span class="sc">^</span>(beta<span class="dv">-1</span>) <span class="sc">/</span><span class="fu">beta</span>(alpha, beta))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  thetahat</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Using the function estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x= 0.1,0.2,\ldots ,0.9\)</span>. And compare with <strong>pbeta</strong> function.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">MC_Beta</span>(x),<span class="dv">5</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>theoretical <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x, <span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(estimate, theoretical,<span class="at">row.names =</span> x)</span></code></pre></div>
<pre><code>##     estimate theoretical
## 0.1  0.00871     0.00856
## 0.2  0.05893     0.05792
## 0.3  0.16599     0.16308
## 0.4  0.32326     0.31744
## 0.5  0.50943     0.50000
## 0.6  0.69580     0.68256
## 0.7  0.85353     0.83692
## 0.8  0.96097     0.94208
## 0.9  1.01086     0.99144</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, estimate,<span class="st">&#39;l&#39;</span>,<span class="at">col =</span><span class="dv">1</span>,)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, theoretical, <span class="at">col =</span><span class="dv">2</span>,)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">expression</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>), <span class="fu">expression</span>((X<span class="sc">+</span>X<span class="sc">^</span>{prime})<span class="sc">/</span><span class="dv">2</span>) )</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can find the MC estimate value is close to the value generate from <strong>pbeta</strong> function in R.</p>
</div>
<div id="the-rayleigh-density-is" class="section level3">
<h3>5.9: The Rayleigh density is</h3>
<p><span class="math display">\[f(x) = \frac{x}{\sigma^2} e^{-x^2/(2 \sigma^2)}, x\ge 0, \sigma&gt;0 \]</span> Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span> ?</p>
<p>I use inverse transform method to solve the problem.</p>
<p><span class="math display">\[F(x) = \int_0^x \frac{t}{\sigma^2} e^{-t^2/(2\sigma^2)}=1-e^{-x^2/(2\sigma^2)}\]</span></p>
<p><span class="math display">\[F^{-1}(u) = \left( -2\sigma^2 \log(1-u) \right)^{\frac{1}{2}},0&lt;u&lt;1\]</span>.</p>
<p><span class="math display">\[F^{-1}(1-u)= \left( -2\sigma^2 \log(u) \right)^{\frac{1}{2}},0&lt;u&lt;1 \]</span> The function to generate samples from a Rayleigh(σ) distribution, using antithetic variables, as follows:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">sigma =</span> <span class="dv">1</span>,<span class="at">antithetic =</span> <span class="cn">TRUE</span>){</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) X <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U[<span class="dv">1</span><span class="sc">:</span>(n)]))<span class="sc">*</span>sigma <span class="sc">+</span>  <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U[<span class="dv">1</span><span class="sc">:</span>(n)]))<span class="sc">*</span>sigma <span class="cf">else</span> X <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))<span class="sc">*</span>sigma <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))<span class="sc">*</span>sigma</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  X<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> <span class="fu">sampling</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">sampling</span>(<span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.9723522</code></pre>
<p>We can find the the percent reduction in variance achieve 97%.</p>
</div>
<div id="find-two-importance-functions-f_1-and-f_2-that-are-supported-on-1infty-and-are-close-to" class="section level3">
<h3>5.13: Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to</h3>
<p><span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
<p>The importance function that are supported on <span class="math inline">\((1, \infty)\)</span> are Exponential Distribution and Normal Distribution.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span>  <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(g<span class="sc">/</span>f[<span class="dv">1</span>](x)<span class="sc">==-</span>x<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(g<span class="sc">/</span>f[<span class="dv">2</span>](x)<span class="sc">==</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>e<span class="sc">^</span>{(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>x}))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The exponential distribution has the smaller variance. The reason is that <span class="math inline">\(g/f_2\)</span> is closer to constant which means <span class="math inline">\(f_2(x)\)</span> is closer to <span class="math inline">\(g(x)\)</span>.</p>
</div>
<div id="obtain-a-monte-carlo-estimate-of" class="section level3">
<h3>5.14 Obtain a Monte Carlo estimate of</h3>
<p><span class="math display">\[\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}}e^{-x^2/2}dx\]</span> by importance sampling.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) <span class="co">#using normal distribution f1 =1/sqrt(2*pi) *exp(-x^2/2)</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>) <span class="co"># g/f = x^2 (x&gt;1)</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)<span class="sc">/</span><span class="fu">sqrt</span>(m)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using exponential distribution f2 = e^(-x)</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)<span class="sc">/</span><span class="fu">sqrt</span>(m)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">est=</span><span class="fu">round</span>(est,<span class="dv">5</span>), <span class="at">sd=</span><span class="fu">round</span>(sd,<span class="dv">5</span>))</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">f1</th>
<th align="center">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="center">0.38886</td>
<td align="center">0.39612</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="center">0.01117</td>
<td align="center">0.00585</td>
</tr>
</tbody>
</table>
<p>From the result we can find the exponential distribution has the smaller variance, which is consistent with 5.14.</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R). If we obtain the powers for two methods under a particular</p>
<p>simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<ul>
<li><p>I What is the corresponding hypothesis test problem?</p></li>
<li><p>I What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>I Please provide the least necessary information for hypothesis testing.</p></li>
</ul>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
</div>
<div id="suppose-a-95-symmetric-t-interval-is-applied-to-estimate-a-mean-but-the" class="section level3">
<h3>6.5: Suppose a 95% symmetric t-interval is applied to estimate a mean, but the</h3>
<p>sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>If X 1 ,…,X n is a random sample from a chisq(2) distribution, the mean value is 2. The test statistic <em>t</em> = <span class="math inline">\(\frac{\bar{x}-2}{s} \sim t(2)\)</span>, where s is the variance of sample, the t interval is <span class="math inline">\((\bar{x}-\frac{\sigma_x}{\sqrt{n-1}} t_{1-\alpha/2}(2),\bar{x}+\frac{\sigma_x}{\sqrt{n-1}} t_{1-\alpha/2}(2))\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> U <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  L[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span>(<span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  U[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span>(<span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(L<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> U<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9254</code></pre>
<p>Compare the t-interval results with the simulation results in Example 6.4,we find that this coverage probability of the t-interval is smaller.</p>
</div>
<div id="a-use-monte-carlo-simulation-to-investigate-whether-the-empirical-type-i-error-rate-of-the-t-test-is-approximately-equal-to-the-nominal-significance-level-alpha-when-the-sampled-population-is-non-normal.-the-t-test-is-robust-to-mild-departures-from-normality.-discuss-the-simulation-results-for-the-cases-where-the-sampled-population-is-i-χ21-ii-uniform02-and-iii-exponentialrate1.-in-each-case-test-h0-µ-µ0-vs-h0-µ-µ0-where-µ0-is-the" class="section level3">
<h3>6.A: Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : µ = µ0 vs H0 : µ ̸= µ0, where µ0 is the</h3>
<p>mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
<ol style="list-style-type: lower-roman">
<li>The mean values of chisq(1),Uniform(0,2) and Exponential(1) are all 1.</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># null hypothesis!</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span>; n <span class="ot">&lt;-</span> <span class="dv">20</span>; <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df =</span><span class="dv">1</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  ttest1 <span class="ot">&lt;-</span>  <span class="fu">t.test</span>(x1, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  ttest2 <span class="ot">&lt;-</span>  <span class="fu">t.test</span>(x2, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  ttest3 <span class="ot">&lt;-</span>  <span class="fu">t.test</span>(x3, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  p1[i] <span class="ot">&lt;-</span> ttest1<span class="sc">$</span>p.value</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  p2[i] <span class="ot">&lt;-</span> ttest2<span class="sc">$</span>p.value</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  p3[i] <span class="ot">&lt;-</span> ttest3<span class="sc">$</span>p.value</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha), <span class="fu">mean</span>(p2 <span class="sc">&lt;</span> alpha), <span class="fu">mean</span>(p3 <span class="sc">&lt;</span> alpha))</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>m)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(p.hat, se.hat,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;(i)χ2(1)&quot;</span>, <span class="st">&quot;(ii)Uniform(0,2)&quot;</span>, <span class="st">&quot;(iii)Exponential(1)&quot;</span>))</span></code></pre></div>
<pre><code>##                      p.hat      se.hat
## (i)χ2(1)            0.0133 0.001145561
## (ii)Uniform(0,2)    0.0486 0.002150303
## (iii)Exponential(1) 0.0189 0.001361719</code></pre>
<p>The observed Type I error rate of chisq2(1), Uniform(0,2), and Exponential(1) are 0.0133, 0.0486, 0.0189 and the standard error of the estimate are 0.001145561, 0.002150303, 0.001361719. The estimates of Type I error probability are vary ,but should be close to the nominal rate <span class="math inline">\(\alpha\)</span>= 0.05. Howere ,we find that only the Type I error probability of uniform(0,2) is close to 0.05. When n is large enough , the Type I error of chisq2(1) and Exponential(1) will close to 0.05.</p>
</div>
<div id="simulation-setting-with-10000-experiments-say-0.651-for-one-method-and-0.676-for-another-method.-we-want-to-know-if-the-powers-are-different-at-0.05-level." class="section level3">
<h3>simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</h3>
<ul>
<li><p>I What is the corresponding hypothesis test problem?</p></li>
<li><p>I What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>I Please provide the least necessary information for hypothesis testing.</p></li>
</ul>
<p>(1)if we make powers for two methods under a particular simulation is p1 and p2,the corresponding hypothesis test problem is <span class="math display">\[H_0 :p_1=p_2 \quad vs \quad H_1:p_1 \not=p_2\]</span></p>
<p>(2)In my opinion,we can use Z-test, paired-t test or McNemar test, in Z-test we can make <span class="math inline">\(Z_i = Y_i − X_i\)</span>,paired-t test and McNemar test are used for the analysis of paired count data, and they can analyze whether the results before and after the experiment are different.However,two-sample t-test requires the samples to be independent. Obviously, the samples in the question are the same set of samples, which cannot be independent of each other,thus we shouldn’t choose it.</p>
<p>(3)To test my hypothesis, we need to know Sample mean,Sample var,Sample size etc, .</p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>6.C Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1,d} = E[(X-\mu)^T \Sigma^{-1}(Y-\mu)]^3.
\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewwness statistic is <span class="math display">\[
b_{1,d}= \frac{1}{n^2} \sum_{i,j=1}^{n}((X_i-\bar{X})^T \hat{\Sigma}^{-1} (X_j-\bar{X}))^3,
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquqred with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
<p>Example 6.8</p>
<p>The hypotheses are <span class="math display">\[
H_0 : \sqrt{\beta_{1,d}} =0; \quad H_1 : \sqrt{\beta_{1,d}} \ne 0,
\]</span> where the sampling distribution of the skewness statistic is derived under the assumption of normality. Assess the Type I error rate for a skewness test of normality at <span class="math inline">\(\alpha\)</span> = 0.05 based on the asymptotic distribution of <span class="math inline">\(\sqrt{b_1}\)</span> for sample sizes n = 10, 20, 30, 50, 100, and 500.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># genrate multi-normal distribution</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co"># sample size</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># dimension</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>cv_U <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>cv_L <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.025</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>mul_sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(x[,<span class="dv">1</span>]),<span class="fu">mean</span>(x[,<span class="dv">2</span>])),n,<span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  x_ <span class="ot">&lt;-</span> x<span class="sc">-</span>x_bar</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  sigma_hat <span class="ot">&lt;-</span> <span class="fu">var</span>(x)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="co"># MLE</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">mean</span>((x_ <span class="sc">%*%</span> <span class="fu">solve</span>(sigma_hat) <span class="sc">%*%</span> <span class="fu">t</span>(x_))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">*</span>b<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>((<span class="fu">mul_sk</span>(x) <span class="sc">&lt;=</span>cv_L) <span class="sc">|</span>( <span class="fu">mul_sk</span>(x)<span class="sc">&gt;=</span> cv_U))</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p.reject)</span></code></pre></div>
<pre><code>## [1] 0.050 0.055 0.057 0.044 0.054 0.050</code></pre>
<p>Example 6.10</p>
<p>For this experiment, the significance level is <span class="math inline">\(\alpha\)</span> = 0.1 and the sample size is n = 30. The skewness statistic mul_sk is implemented in Example 6.8.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2500</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#critical value for the skewness test</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>cv_U <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>cv_L <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(alpha<span class="sc">/</span><span class="dv">2</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for each replicate</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e)))</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(a<span class="sc">==</span><span class="dv">0</span>){x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n,mu,sigma1)}</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(a<span class="sc">==</span>n){x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n,mu,sigma2)}</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {x1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n<span class="sc">-</span>a,mu,sigma1)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>          x2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(a,mu,sigma2)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>          x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1,x2)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">mul_sk</span>(x) <span class="sc">&lt;=</span> cv_L <span class="sc">|</span> <span class="fu">mul_sk</span>(x) <span class="sc">&gt;=</span>cv_U )</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co">#add standard errors</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7,7.8,7.9，and 7.B(pages 213, Statistical Computing with R)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>7.7</h3>
<p>Referto Exercise7.6. Efron and Tibshirani discuss the following example [84, Ch.7]. The ﬁve-dimensional scores data have a 5×5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigen values <span class="math inline">\(\lambda_1&gt; \cdots&gt;\lambda5\)</span>. In principal components analysis, <span class="math display">\[ 
 \theta=\frac{\lambda_1}{\sum_{j=1}^{5} \lambda_j}
\]</span></p>
<p>measures the proportion of variance explained by the ﬁrst principal component. Let <span class="math inline">\(\hat\lambda_1&gt; \cdots&gt;\hat\lambda5\)</span> be the eigen values of <span class="math inline">\(\hat\Sigma\)</span>,where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[ 
 \hat{\theta}=\frac{\hat{\lambda_1}}{\sum_{j=1}^{5} \hat{\lambda_j}}
\]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> (eig<span class="sc">$</span>value[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> scor[i,]</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  sigma.i <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.i)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  theta[b] <span class="ot">&lt;-</span> (eig<span class="sc">$</span>values[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>bias.theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta.hat<span class="sc">-</span>theta)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>se.theta <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">bias =</span> bias.theta, <span class="at">se=</span>se.theta))</span></code></pre></div>
<pre><code>## $bias
## [1] 0.002039819
## 
## $se
## [1] 0.04948062</code></pre>
<p>The results of bootstrap are as above.</p>
</div>
<div id="section-1" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise7.7.Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> (eig<span class="sc">$</span>value[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  sigma.i <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.i)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  theta[i] <span class="ot">&lt;-</span> (eig<span class="sc">$</span>values[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>bias.theta <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta)<span class="sc">-</span>theta.hat)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>se.theta <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta<span class="sc">-</span><span class="fu">mean</span>(theta))<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">bias =</span> bias.theta, <span class="at">se=</span>se.theta))</span></code></pre></div>
<pre><code>## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<p>The results of jackknife are as above. Compare with Bootstrap, it has smaller bias but higer variance.</p>
</div>
<div id="section-2" class="section level3">
<h3>7.9</h3>
<p>Refer to Exercise7.7. Compute 95% percentile and BCa conﬁdence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> (eig<span class="sc">$</span>value[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>theta.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(x,ind){</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  sigma.i <span class="ot">&lt;-</span> <span class="fu">cov</span>(x[ind,])</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.i)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  eig<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(scor,<span class="at">statistic =</span> theta.boot, <span class="at">R =</span> <span class="dv">100</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 100 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5193,  0.7258 )   ( 0.5177,  0.7258 )  
## Calculations and Intervals on Original Scale
## Some percentile intervals may be unstable
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="b" class="section level3">
<h3>7.B</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">=</span>ci.basic<span class="ot">=</span>ci.perc<span class="ot">=</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">=</span><span class="cf">function</span>(x){ </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  x.bat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> <span class="fu">mean</span>((x <span class="sc">-</span> x.bat)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">=</span> <span class="fu">mean</span>((x <span class="sc">-</span> x.bat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (m1<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>boot.median<span class="ot">=</span><span class="cf">function</span>(x,ind) <span class="fu">sk</span>(x[ind])</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># normal populations</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.median,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">=</span><span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">=</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">=</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">=</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>p1.norm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu<span class="sc">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>p1.basic<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu<span class="sc">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>p1.perc<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu<span class="sc">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(p1.norm,p1.basic,p1.perc,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</span></code></pre></div>
<pre><code>##              p1.norm p1.basic p1.perc
## coverage       0.916    0.922   0.942
## on the left    0.049    0.048   0.035
## on the right   0.035    0.030   0.023</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># χ2(5) distributions</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">=</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.median,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">=</span><span class="fu">boot.ci</span>(de,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">=</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">=</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">=</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>p2.norm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu1<span class="sc">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu1),<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu1),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu1))</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>p2.basic<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu1<span class="sc">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu1),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu1),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu1))</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>p2.perc<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu1<span class="sc">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu1),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu1),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu1))</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(p2.norm,p2.basic,p2.perc,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</span></code></pre></div>
<pre><code>##              p2.norm p2.basic p2.perc
## coverage       0.779    0.766   0.762
## on the left    0.025    0.042   0.000
## on the right   0.196    0.192   0.238</code></pre>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-3" class="section level3">
<h3>8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
<p>I generate two normal sample with 12 samples. They are iid. The hypothes is <span class="math display">\[
H_0: \text{the bivariate Spearman rank is not correlation}
\]</span> <span class="math display">\[
H_0: \text{the bivariate Spearman rank is correlation}
\]</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span>(<span class="dv">1</span><span class="sc">:</span>R)){</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">12</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  t[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0,t) <span class="sc">&gt;=</span> t0)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1,p2)</span></code></pre></div>
<pre><code>## [1] 0.8170000 0.6551967</code></pre>
<p>The significance level of the permutation test of the bivariate Spearman rank correlation test is <code>p1</code>, the bivariate Spearman rank correlation test is <code>p2</code>. They both bigger than <span class="math inline">\(\alpha=0.05\)</span>. So is null hypothesis is accept. What’s more ,we have p1 &gt; p2,which means significance level of the permutation test is more obvious.</p>
</div>
<div id="section-4" class="section level3">
<h3></h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul>
<p>In the first case, I set the two variable ,x and y, have 1 and 1.5 variance,respectively.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN) </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z);</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;=</span> n1); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>(i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)}</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> p4 <span class="ot">&lt;-</span> p5 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>  z1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1, y1)</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z1,N,k)<span class="sc">$</span>p.value</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z1,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x1,<span class="at">y=</span>y1,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>pow1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p1<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>pow1</span></code></pre></div>
<pre><code>## [1] 0.257 0.324 0.862</code></pre>
<p>When unequal variances and equal expectations, the performance of three methods are all good, but the ball method is best, NN method is worst.</p>
<p>In the second case, I set the two variable ,x and y, have 0 and 0.5 mean ,1 and 1.5 variance,respectively.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  z2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x2, y2)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z2,N,k)<span class="sc">$</span>p.value</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z2,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x2,<span class="at">y=</span>y2,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>pow2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p2<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>pow2</span></code></pre></div>
<pre><code>## [1] 0.554 0.880 0.973</code></pre>
<p>When unequal variances and unequal expectations, the performance of three methods are all good, but the ball method is best, NN method is worst.</p>
<p>In the third case, I set y is the mixture of two normal distributions with 0,5 and 1 mean ,2 and 3 variance,respectively.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Non-normal distributions: t distribution with 1 df，bimodel distribution</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(<span class="dv">100</span>,<span class="at">df=</span><span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>()</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>      r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">1</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">&lt;-</span><span class="fu">ifelse</span>(r<span class="sc">==</span><span class="dv">0</span>,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">2</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  y3<span class="ot">&lt;-</span><span class="fu">matrix</span>(y,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  z3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x3, y3)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z3,N,k)<span class="sc">$</span>p.value</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z3,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x3,<span class="at">y=</span>y3,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>pow3 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p3<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>pow3</span></code></pre></div>
<pre><code>## [1] 0.647 0.686 0.632</code></pre>
<p>When non-normal distributions: t distribution with 1 df，bimodel distribution, the performance of three methods are almost same, but the energy method is best, NN method is worst.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unbalanced samples</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>n3<span class="ot">&lt;-</span><span class="dv">25</span>;n4<span class="ot">&lt;-</span><span class="dv">250</span>;n5 <span class="ot">&lt;-</span> n3<span class="sc">+</span>n4;N1<span class="ot">&lt;-</span><span class="fu">c</span>(n3,n4)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  x4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  y4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  z4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x4, y4)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z4,N1,k)<span class="sc">$</span>p.value</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z4,<span class="at">sizes=</span>N1,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x4,<span class="at">y=</span>y4,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>pow4 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p4<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>pow4</span></code></pre></div>
<pre><code>## [1] 0.076 0.088 0.861</code></pre>
<p>When unbalanced samples, the performance of three methods are far different. NN method and energy method is very bad, but the ball method is good.</p>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</li>
<li>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2.</li>
</ul>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-5" class="section level3">
<h3>9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and com- pare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy<span class="math inline">\((\theta,\eta)\)</span> distribution has density function</p>
<p>使用建议分布选正态分布<span class="math inline">\(N(X_t,\sigma^2)\)</span>实现随机游动形式的Metropolis样本生成器。 此时 <span class="math display">\[
r(x_t,y)=\frac{f(Y)}{f(X_t)} =\frac{1+x_t^2}{1+y^2}
\]</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span>N)) {</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (u[i] <span class="sc">&lt;</span> ((<span class="dv">1</span><span class="sc">+</span>x[i<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>            k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>,  <span class="dv">4</span>)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="co"># no.reject &lt;- data.frame(theta=theta,no.reject=c(rw1$k, rw2$k, rw3$k, rw4$k))</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="co"># # knitr::kable(no.reject)</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="co"># no.reject</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    refline <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,  rw4<span class="sc">$</span>x)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></span></code></pre></div>
<ul>
<li>Quantiles of the generated samples</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    Q <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x, rw4<span class="sc">$</span>x)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    mc <span class="ot">&lt;-</span> rw[<span class="dv">501</span><span class="sc">:</span>N, ]</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    Qrw <span class="ot">&lt;-</span> <span class="fu">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, a))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    qq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(qq) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=1&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(qq) <span class="co">#latex format</span></span></code></pre></div>
<p>可以看到，<span class="math inline">\(\sigma^2=1\)</span>时的分位数与真实值比较接近。</p>
</div>
<div id="section-6" class="section level3">
<h3>9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1},\ x=0,1,\ldots,n,0 \le y \le 1.
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f (x, y)\)</span>.</p>
<p>条件分布： <span class="math display">\[
f(x|y) \sim B(n,y)
\]</span> <span class="math display">\[
f(y|x) \sim Beta(x+a,n-x+b)
\]</span></p>
<pre><code>## Means:  1.01 0.5</code></pre>
<pre><code>## Standard errors:  0.81 0.29</code></pre>
<pre><code>## Correlation coefficients:  0.71</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="gelman-rubin-method-to-monitor-convergence-of-the-chain-and-run-the-chain-until-it-converges-approximately-to-the-target-distribution-according-to-hatr1.2." class="section level2">
<h2>Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2.\)</span></h2>
<div id="section-7" class="section level3">
<h3></h3>
<div id="section-8" class="section level4">
<h4>9.3</h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="dv">2</span>    <span class="co">#parameter of proposal distribution</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate the chains</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma, x0[i], n)<span class="sc">$</span>x</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co">#    par(mfrow=c(2,2))</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">col=</span>i)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYil+Y6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZrY6kNth0E9mAABmADpmOgBmOjpmZjpmZmZmZpBmtrZmtv+QOgCQZgCQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2tpC2tra2ttu229u22/+2/7a2///bkDrbkGbbtrbb2//b/9vb///fU2v/tmb/25D/27b/29v//7b//9v///8UvhhqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI0klEQVR4nO2dCX+bNhyG1W6tu3VHyI508brDW3bU61acLeb7f7IhCWEOiVcIySjx+/zaFKj4SzyRBMICi4pMItYuQO5QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAPEHHrVA8f+cKt5RNw+JAiCSC9uJKLxzMwpCimBPPwkb/lCyMNE0SQcdtq2X/4oM1SVEsVHTSsumhoy8K3SOJoIfrW7N4cDQysdBQaas3tZ7NpigWy++yVg2S4eYehaWqWBKpqJkLqvugpgo5+6COIL9ft3Gi6oepJ4O6Uq8Uj0NQ3cj0KcBRfxpB8oiL5oj1Znm85uCKjoRC+pH/FoUuSKnSFSpV1d0hdieUSJBPOH3M7eF3a4WuIr0WVZuR/ZY575an8vQr0yJBls5rVUFNhyGrUl0ytSKLOOxmNjpZ76qkdJVniSBb555a0N5xFtOVYlMoDVpFs7jprLlLgATZuqgetv+zJT5zDepeCFedRqT+c/r01C+AU1DV398lqCiMxc6mDAS1GCX+e4QKKk4uurQJLNvc2XqXbzHzxweBglBTm5dtjIQKPFidFW68h6+gxaw1WL1sQZ5DjXn0T2KPW5DPYHVGOLNHWdOslO4Aj0FQxBpU6j+adqF85II8B6sj6uMu9d+RD7NHW4liCNpY8CqojfiD1XK0sSxPiiojxlEA573Q9hA3p0tzFybUxI3VFcdiFkFTq8MCOAW1l+WDO7Knm8yi2SjaAZ77/vN6gkooaLoA7jbmGLGI7qL1nvzlCLLu3xVkb1PCJOy4W01QORRUjrb0d/AW5ArgkcRSr9YazYuyV1+AHVv+/gUSoB+el+/ihH6UXUHQji1/XKCQj/9wvosT+tER5KNnvqBFVvyzCUjoHa69JAQpHZ3lxKXLsjrjm01oQv9wpYcf99nEXqCYbiayWZLQP5xP0xK6ClmO2lKg2HIc2SxM6B/Ot+sR1nHFcFv0unMqQNyE/uG8BU1d1jXLSeQMc4mTMGo4IapxXemFWHoahyWInjBquKlk7RgzSoFCShCWMGo4JChKWYJLEJYwZrjJ2kFBUFDi1tXkEjthxHDT/Uvq3qfJJXrC2eGckc8iALHa7Y7OJkfKc/QwmNVrkOsqMPn525P1BVkiKzl5+En1yar8NOzgNXnBIigTNZp0gtRnqp0PoR3hhoJyaVqGZIIaNfCj54GgzPQkFHT/SgmCkxeGgvI4d51YuwYNz+aZ6UkmSPYkLyvTXU+EGwyocmtg6U7ztaNnP7sndzgFzcvlDKx9HdQXlF8FykFQJ3R+fpILcs20twrKsAKFCHr/9s3v0fLtC1ocNj6zBT18/ez161cfu4YQc8M9PUG//CR//vvGNbcORBne7nhago5vb7797EbxzRc3gY76+T4xQe/vfn1zp3j7491vFGRLqJrY8a8vp9KaOa4TT2s04cTTE3Tcio9eCdBJH7fOG0H9cKJXhichqKr+u7v7A6U+bl96hXuSgrw4CMedsn64yxXkF677M34eUVh7LNZbvjRBnYd+JsNREAhHQSAcBYFwFATCXawgWxTbswEUBMJREAhHQSAcBYFwFATCURAI195dpCB7OGHZlg0UBKAgAAUBKAhAQYCMBGV5ls9IUHbzWzX53O7I009ONShuBrGgIEAiQbNeNKmWM21hiQTNe9GkmB3/jCQRNPM1gZcnaOaLJvXLOWbEPyc51CC5kqufZH3QrBdNXp4gv29F6K5cmqB54SgIhMvmCV4LqQWhZzWalWz9ZFOD4kaPCAUBcrjdcbGCDkI+lukRLtN7ZYpEgnZCXN1//sHjxQJqJV8/iQTt6gvEnao9fkONSxOk6s39J1KQ17ciXKAgOQI7/l2xBjloLw/hiwX0ysUJqvb69OV+pOXSBc0Ll7GfpIJ850lTUJxw60BBAAoCUBBgtbPYo2ElQb4ZzNmaLoQPFASgIAAFASgIQEEACgJQEICCAI9mbLAWFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCBBbkHrkTn1u1k5lHC8A9nWI2wUh7j81s7t2ahpTeEmq6IKO2zrjvfxykoP8/g1ZivECYK++ueM2OMTDtZnGdFAPlYSXRBJZkP7qn/3zd/rj193LarwA0G8ctu7pFeLQPjH6cC0FhZdEkaQPqn87ranxAti5FRQW4iCuzATK/Yvva0HhJVEkEbSrC2Hmeo4X0N6miQWHaBLUqWUftKAkkhSC5ON2uonXP8cLHvsL01MEhdCHLhuSFLSkJFUSQQfTRwcWq65/dbtY4FgLkhNxsxSkH9cMr9inrmJRE1Npc2xizbP14V1j+/sNDqEOfd9Mc7nNrJM2z/2Gn1x18Q8LrhROdWOX3Wle9h1NKYMvz0wfFByiLyivC8WmYsvM9+ZyfrwA2JnRSmCIgaAFJak4WIVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAPkJGs0q8J1mkAYKAlAQIEtBD9ffXevJ9nKeyg/NZBo5JUZOC3O+5TIJmQqS8/Xrv3Iu1UE0K3JSlZwc5npNahoyFXSlpuLp2Xi7ZoOaGHV4/udXZ21xmQq6Ve8e1lPF2om7ytdO+M0tjEXWgvatIDNldeo9smnIWtCgBkmO2xu/6buxyFpQM6G52aDYv/hn4jWOCchaUPNcS3MW0731re8U+UjkLah/HVSL0TPDz9lN5ycoMygIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/Frj286D+k58AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看到<span class="math inline">\(\sqrt{\hat{R}}\)</span>并未小于1.2，此时的Metropolis-Hastings链并未收敛。</p>
</div>
<div id="section-9" class="section level4">
<h4>9.8</h4>
</div>
</div>
</div>
<div id="r-libraryr2openbugs-n---1e4-j---nrowschools-y---x-1-sigma.y---x-2-data---list-n-j-x1-x2-inits---function-listtheta-rnormj-0-100-mu.theta-rnorm1-0-100-sigma.theta-runif1-0-100-bugsdtainits-parameters-n.chains-3-n.iter-n-codapkgtrue-librarycoda-mymodel.coda---read.bugsschools.sim" class="section level1">
<h1><code>{r} # library(R2OpenBUGS) # N &lt;- 1e4 # J &lt;- nrow(schools) # y &lt;- X[ ,1] # sigma.y &lt;- X[ ,2] # data &lt;- list (&quot;N&quot;, &quot;J&quot;, &quot;x1&quot;, &quot;x2&quot;) # inits &lt;- function(){ #   list(theta = rnorm(J, 0, 100), mu.theta = rnorm(1, 0, 100), #     sigma.theta = runif(1, 0, 100)) # } #  # bugs(dta,inits = ,parameters = ,n.chains = 3, n.iter = N, codaPkg=TRUE) #  # library(coda) # myModel.coda &lt;- read.bugs(schools.sim) #</code></h1>
</div>
<div id="rechofalse-plot-the-sequence-of-r-hat-statistics-rhat---rep0-n-for-j-in-b1n-rhatj---gelman.rubinpsi1j-plotrhatb1n-typelylim-c03-xlab-ylabr-ablineh1.2-lty2" class="section level1">
<h1><code>{r,echo=FALSE} #      #     #plot the sequence of R-hat statistics #     rhat &lt;- rep(0, n) #     for (j in (b+1):n) #         rhat[j] &lt;- Gelman.Rubin(psi[,1:j]) #     plot(rhat[(b+1):n], type=&quot;l&quot;,ylim = c(0,3) ,xlab=&quot;&quot;, ylab=&quot;R&quot;) #     abline(h=1.2, lty=2) #</code></h1>
<p>未做出来。</p>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</li>
<li>Suppose <span class="math inline">\(T_1,\ldots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_i I(T_i \le \tau) + \tau I(T_i &gt; \tau),i = 1, \ldots , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</li>
</ul>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="section-10" class="section level3">
<h3>11.3</h3>
<div id="a" class="section level4">
<h4>(a)</h4>
<p>防止计算时溢出,计算<span class="math inline">\(\frac{\| \boldsymbol{a} \|^{2k+2}}{(2k+1)(2k+2)}\)</span>时，先计算其对数值再用exp计算，同样使用lgamma函数计算<span class="math inline">\(\frac{ \Gamma(\frac{d+1}{2}\Gamma(k+\frac{3}{2})} {k!\ \Gamma(k+d/2+1)}\)</span>,。</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>f_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k,d,a) {</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">norm</span>(<span class="fu">as.matrix</span>(a),<span class="st">&quot;F&quot;</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k)<span class="sc">-</span><span class="fu">lgamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span><span class="dv">1</span>)) </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,d)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">f_k</span>(<span class="dv">1</span>,d,a)</span></code></pre></div>
<pre><code>## [1] -2.190891</code></pre>
</div>
<div id="b-1" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>f_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(d,a) {</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  sk<span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">norm</span>(<span class="fu">as.matrix</span>(a),<span class="st">&quot;F&quot;</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k)<span class="sc">-</span><span class="fu">lgamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(sk) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps) {<span class="cf">break</span>}</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> s<span class="sc">+</span>sk</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">sum =</span> s, <span class="at">k =</span> k))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,d)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="fu">f_sum</span>(d,a)</span></code></pre></div>
<pre><code>##       sum         k 
## -1.071858 95.000000</code></pre>
</div>
<div id="c" class="section level4">
<h4>(c)</h4>
<p>使用(b)中函数，当<span class="math inline">\(d = 2, \boldsymbol{a}=(1,2)^T\)</span>时，计算和。</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">f_sum</span>(d,a)</span></code></pre></div>
<pre><code>##        sum          k 
## -0.3025684 24.0000000</code></pre>
<p>迭代24次后达到机器精度，和为-0.3025684.</p>
</div>
</div>
<div id="section-11" class="section level3">
<h3>11.4</h3>
<p>与11.5 比较结果</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>root<span class="ot">=</span><span class="cf">function</span>(k){</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">=</span><span class="cf">function</span>(a){</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>((k<span class="dv">-1</span>)<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">=</span><span class="cf">function</span>(a){</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(k<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">s1</span>(a)<span class="sc">-</span><span class="fu">s2</span>(a)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">uniroot</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">1e-6</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">1e-6</span>))<span class="sc">$</span>root)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">root</span>(k)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614517  1.625406
##  [8]  1.634409  1.642026  1.648511  1.654174  1.659121  1.663442  1.667288
## [15]  1.670736  1.673841  1.676589  1.679139  1.681461  4.795831  4.898978
## [22]  4.999999  9.999999 22.360679 31.622776</code></pre>
</div>
<div id="section-12" class="section level3">
<h3>11.5</h3>
<p><span class="math display">\[
\frac{\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\left (1+\frac{u^2}{k-1}\right )^{-k/2}
\]</span> 是自由度为<span class="math inline">\(k-1\)</span>的t分布的概率密度函数。所以<span class="math inline">\(2\frac{\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}\left (1+\frac{u^2}{k-1}\right )^{-k/2}=2(P(t(k-1)&lt;c_{k-1})-1/2)\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>find_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S1 &lt;-function(a){</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   jifen = integrate(function(u) { (1 + u^2/(k-1) )^(-k/2)},lower = 0, upper = sqrt(a^2*(k-1)/(k-a^2)) )$value</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   2* exp( lgamma(k/2)-lgamma( (k-1)/2) )/ sqrt(  pi*(k-1) ) * jifen</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S2 &lt;-function(a){</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   jifen = integrate(function(u) { (1+u^2/k)^(-(k+1)/2)},lower = 0, upper = sqrt(a^2*k/(k+1-a^2)) )$value</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   2* exp( lgamma( (k+1)/2 )-lgamma(k/2) )/ sqrt( pi*k ) * jifen</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">*</span>( <span class="fu">pt</span>( <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>) <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">*</span>( <span class="fu">pt</span>( <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k) <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">S1</span>(a)<span class="sc">-</span><span class="fu">S2</span>(a)</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">uniroot</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">1e-6</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">1e-6</span>))<span class="sc">$</span>root)</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">find_a</span>(k)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614517  1.625406
##  [8]  1.634409  1.642026  1.648511  1.654174  1.659121  1.663442  1.667288
## [15]  1.670736  1.673841  1.676589  1.679139  1.681461  4.795831  4.898978
## [22]  4.999999  9.999999 22.360679 31.622776</code></pre>
<p>结果与11.4一致。</p>
</div>
<div id="em" class="section level3">
<h3>EM</h3>
<p>Suppose <span class="math inline">\(T_1,\ldots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_i I(T_i \le \tau) + \tau I(T_i &gt; \tau),i = 1, \ldots , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
<p>小于1的7个数记为<span class="math inline">\(X_1,\ldots,X_7\)</span>,等于1的3个数几位<span class="math inline">\(Z_1,Z_2,Z_3\)</span></p>
<ul>
<li><p>MLE求解：<span class="math inline">\(X_1,\ldots,X_7\)</span>是服从参数为<span class="math inline">\(\lambda\)</span>的指数分布，<span class="math inline">\(Z_1,Z_2,Z_3\)</span>的概率为<span class="math inline">\(\int_1^{\infty}\lambda e^{-\lambda x}dx=e^{-\lambda}\)</span>. 则似然函数为<span class="math inline">\(L(\lambda)=\lambda^7 e^{-\lambda(X_1+\cdots+X_7)}(e^{-\lambda})^3\)</span>.其对数似然函数为<span class="math inline">\(LL(\lambda) = 7log\lambda-\lambda \sum_i X_i -3\lambda\)</span>. 易得最大值<span class="math inline">\(\hat{\lambda} = \frac{7}{\sum_i X_i +3}=28/27\)</span>。</p></li>
<li><p>EM求解： E步：</p></li>
</ul>
<p><span class="math inline">\(Z|X,\lambda^{i} \sim \lambda e^{-\lambda z}/e^{-\lambda},z\ge 1. \ E[Z|X,\lambda^i]= \frac{1}{e^{-\lambda}} \int_1^{\infty}\lambda^i e^{-\lambda^ix}dx=\frac{\lambda^i+1}{\lambda^i}\)</span> 从而<span class="math inline">\(Q(\lambda,\lambda^i)=E_z[logL(\lambda;X,Z)|X,\lambda^i]= 10log\lambda-\lambda \sum_i X_i - \lambda \sum_iZ_i= 10log\lambda-\lambda \sum_i X_i - \frac{\lambda^i+1}{\lambda^i}3\lambda\)</span>.</p>
<p>M步:</p>
<p>对<span class="math inline">\(Q(\lambda,\lambda^i)\)</span>求最大值得<span class="math inline">\(\lambda^{i+1} = \frac{10}{\sum_i X_i+\sum_iZ_i}=\frac{10}{\sum_iX_i+3+3/\lambda^i}\)</span>.当<span class="math inline">\(\lambda\)</span>收敛时，<span class="math inline">\(\lambda = \frac{10}{\sum_i X_i+3+3/\lambda}\)</span>,解得<span class="math inline">\(\hat\lambda = \frac{7}{\sum_i X_i +3}=28/27\)</span>.与MLE的结果相同。</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># \sum_i X_i+3 = \sum_i Y_i</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.91</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> lambda0 <span class="ot">=</span> <span class="dv">1</span> <span class="co">#inital est. for lambdas</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">=</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>){</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">=</span> <span class="fu">rep</span>((lambda<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>lambda,<span class="dv">3</span>) <span class="co">#E step</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(X)<span class="sc">+</span><span class="fu">sum</span>(Z)) <span class="co">#M step</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda<span class="sc">-</span>lambda0) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  lambda0 <span class="ot">=</span> lambda</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">est =</span> lambda,<span class="at">true =</span><span class="dv">28</span><span class="sc">/</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>##      est     true 
## 1.037037 1.037037</code></pre>
<p>可见，EM算法的结果与真实结果相同。</p>
</div>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 1 and 5 (page 204, Advanced R)</li>
<li>Excecises 1 and 7 (page 214, Advanced R)</li>
</ul>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercises-1-page-204-advanced-r" class="section level3">
<h3>Exercises 1 (page 204, Advanced R)</h3>
<p>Why are the following two invocations of lapply() equivalent?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.127382
## 
## [[2]]
## [1] 0.05010048
## 
## [[3]]
## [1] 0.04571294
## 
## [[4]]
## [1] 0.1398861</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.127382
## 
## [[2]]
## [1] 0.05010048
## 
## [[3]]
## [1] 0.04571294
## 
## [[4]]
## [1] 0.1398861</code></pre>
<p>The first use an anonymous function varies the amount of trimming applied when computing the mean of a fixed x. The second doesn’t use FUN NAME instead of FUN.</p>
</div>
<div id="exercises-5-page-204-advanced-r" class="section level3">
<h3>Exercises 5 (page 204, Advanced R)</h3>
<p>For each model in the previous two exercises, extract R2 using the function below.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercises 3 </span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data =</span> mtcars)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models, rsq)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>r2</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercises 4</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, data)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps,linear_model)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models, rsq)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>r2</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7131941
## 
## [[2]]
## [1] 0.8032951
## 
## [[3]]
## [1] 0.8170228
## 
## [[4]]
## [1] 0.6159823
## 
## [[5]]
## [1] 0.8036888
## 
## [[6]]
## [1] 0.7901014
## 
## [[7]]
## [1] 0.7749131
## 
## [[8]]
## [1] 0.7131563
## 
## [[9]]
## [1] 0.6410638
## 
## [[10]]
## [1] 0.7425413</code></pre>
</div>
<div id="excecises-1-page-214-advanced-r" class="section level3">
<h3>Excecises 1 (page 214, Advanced R)</h3>
<p>Use vapply() to:</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol></li>
</ul>
<p>使用sd函数计算数值型dataframe每一列标准差</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a)</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>numeric.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(numeric.df, sd, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##       X1       X2       X3       X4       X5       X6 
## 2.973961 2.710064 3.025815 2.319004 3.142893 2.626785</code></pre>
<p>使用R中的CO2数据，前3列为字符型，后两列为数值型，先用is.numeric函数判断是否为数值型，在对数值型的列使用sd函数计算列标准差</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CO2)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>( CO2[ <span class="fu">vapply</span>(CO2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>)) ], sd, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##      conc    uptake 
## 295.92412  10.81441</code></pre>
</div>
<div id="excecises-7-page-214-advanced-r" class="section level3">
<h3>Excecises 7 (page 214, Advanced R)</h3>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
<p>下面是mcsapply()的实现,由于使用windows，mclapply()不能进行并行计算，所以使用parLapply()函数。</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(x, f, ..., <span class="at">mc.cores=</span>1L) {</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># res &lt;- mclapply(x, f, ...,mc.cores = mc.cores) #this can be run in linux</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">4</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterExport</span>(cluster,<span class="st">&quot;pause&quot;</span>,<span class="at">envir =</span> <span class="fu">environment</span>())</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cluster, x, f, ...)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify2array</span>(res)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>可以实现mcvapply()，因为vapply与lapply一样，每个迭代都是与所有其他迭代隔离的，所以它们的计算顺序并不重要，能够并型计算。</p>
</div>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<ul>
<li>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</li>
<li>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</li>
<li>Campare the computation time of the two functions with the function “microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="exercise-9.8-page-278-statistical-computing-with-r" class="section level3">
<h3>Exercise 9.8 (page 278, Statistical Computing with R)</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1},\ x=0,1,\ldots,n,0 \le y \le 1.
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f (x, y)\)</span>.</p>
<p>Rcpp实现的代码如下</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>NumericMatrix <span class="fu">gibbsC</span>(double a,double b,double n){</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  int N <span class="ot">=</span> <span class="dv">10000</span>;</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  NumericMatrix <span class="fu">X</span>(N,<span class="dv">2</span>);</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="ot">=</span> <span class="dv">0</span>;</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="ot">=</span> <span class="fl">0.5</span>;</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  double X1, X2;</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i=</span><span class="dv">1</span>; i<span class="sc">&lt;</span>N; i<span class="sc">++</span>){</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">=</span> <span class="fu">X</span>(i<span class="dv">-1</span>,<span class="dv">1</span>);</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">0</span>) <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,X2)[<span class="dv">0</span>];</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">=</span> <span class="fu">X</span>(i,<span class="dv">0</span>);</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">1</span>) <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,n<span class="sc">-</span>X1<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  return X;</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="compare-the-corresponding-generated-random-numbers-with-pure-r-language-using-the-function-qqplot." class="section level3">
<h3>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</h3>
<p>R实现的9.8的代码如下</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">10000</span>          <span class="co">#样本量</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  <span class="co">#样本阵</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  X</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>cpp文件要与md文件在同一路径下。对R生成随机数于Cpp生成的随机数使用qqplot比较。x,y的qqplot都接近直线说明两个语言生成的随机数相似。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;./&#39;</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir_cpp,<span class="st">&quot;gibbsC.cpp&quot;</span>))</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">25</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>X.R <span class="ot">=</span> <span class="fu">gibbsR</span>(a,b,n)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>X.C <span class="ot">=</span> <span class="fu">gibbsC</span>(a,b,n)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X.R[,<span class="dv">1</span>],X.C[,<span class="dv">1</span>])</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X.R[,<span class="dv">2</span>],X.C[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="compare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark." class="section level3">
<h3>Compare the computation time of the two functions with the function “microbenchmark”.</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(a,b,n),<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(a,b,n))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<p>Cpp代码的运行时间要比R代码的时间快10倍左右。</p>
</div>
<div id="comments-your-results." class="section level3">
<h3>Comments your results.</h3>
<p>结果很明显，Cpp代码的生成的随机数与R代码生成的随机数性能相同，但cpp运行时间要比R的时间快上10倍。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
