<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zhao js" />

<meta name="date" content="2021-12-17" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Zhao js</h4>
<h4 class="date">2021-12-17</h4>



<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="using-inverse-transform-method." class="section level3">
<h3>3.4: Using inverse transform method.</h3>
<p>Because I can’t find a command distribution which has density function <span class="math inline">\(g(x)\)</span> such that there is a constant <span class="math inline">\(c\)</span> satisfy <span class="math inline">\(f(x) \le cg(x)\)</span>, I don’t use acceptance-rejection method.</p>
<p>I use inverse transform method to solve the problem.</p>
<p><span class="math display">\[F(x) = P(X \le x) = \int_{-\infty}^x f(t)dt = \int_0^x \frac{t}{\sigma^2} e^{-t^2/(2\sigma^2)} dt
= \int_0^x -e^{-t^2/(2\sigma^2)} d(-t^2/(2\sigma^2))=(-e^t)|_0^{-x^2/(2\sigma^2)}=1-e^{-x^2/(2\sigma^2)}
\]</span> The inverse function is <span class="math inline">\(F^{-1}(x) = \left( -2\sigma^2 \log(1-x) \right)^{\frac{1}{2}}\)</span>.</p>
<p>The algorithm generating random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>, .<span class="dv">001</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.5</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>, .<span class="dv">001</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>, .<span class="dv">001</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As can be seen from the above three graphs, the mode of the generated samples is close to the theoretical mode.</p>
<p><br />
### 3.11: Generate a random sample of size 1000 from a normal location mixture.</p>
<p>The code to generate a random sample of size 1000 from <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distribution with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span> is as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.75</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.75</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.8</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.8</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.5</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.3</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.35</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.35</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.35</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From above figures with various <span class="math inline">\(p_1\)</span>, I find that when <span class="math inline">\(p_1&gt;0.75\)</span> or <span class="math inline">\(p_1&lt;0.35\)</span> it doesn’t produce bimodal mixtures. Therefore I conjecture when <span class="math inline">\(0.35 \le p_1 \le 0.75\)</span> it produce bimodal mixtures.</p>
<p><br />
### 3.20: Write a program to simulate a compound Poisson<span class="math inline">\((\lambda)\)</span> –Gamma process (Y has a Gamma distribution) Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = λtE[Y_1^2 ]\)</span>.</p>
<p>First, I prove that <span class="math inline">\(E[X(t)] = \lambda t E[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda t E[Y_1^2]\)</span> <span class="math inline">\(proof:\)</span></p>
<p>$$ E[X(t)]=E[_{i=1}^{N(t)}Y_i] = E[N(t)Y_1] = E{E[N(t)Y_1|N(t)]} =E{N(t)E[Y_1]} = E[N(t)]E[Y_1]=tE[Y_1]\</p>
<p>Var(X(t)) = E[X<sup>2(t)]-E</sup>2[X(t)] = E{E[X<sup>2(t)|N(t)]}-E</sup>2[X(t)]=E{Var(X(t)|N(t))+E<sup>2[X(t)|N(t)]}-E</sup>2[X(t)]\ =E{Var(<em>{i=1}<sup>{N(t)}Y_1|N(t))+E</sup>2[</em>{i=1}<sup>{N(t)}Y_1|N(t)]}-E</sup>2[X(t)] = E{N(t)Var(Y_1)}+N(t)^2 E^2[Y_1] }-E^2[X(t)]\ =E[N(t)]Var(Y_1)+E[N(t)<sup>2]E</sup>2[Y_1]-E<sup>2[N(t)]E</sup>2[Y_1]=E[N(t)]Var(Y_1)+Var(N(t))E^2[Y_1]=t Var(Y_1)+t E^2[Y_1]=t E[Y_1^2] $$</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="dv">10</span>;r <span class="ot">&lt;-</span> <span class="dv">1</span>; beta <span class="ot">&lt;-</span><span class="dv">1</span> ; lambda <span class="ot">&lt;-</span><span class="dv">1</span> ;</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t[i], r, beta)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  x_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;mean:&quot;</span>,<span class="fu">mean</span>(x_t))</span></code></pre></div>
<pre><code>## mean: 9.909493</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;variance:&quot;</span>,<span class="fu">var</span>(x_t))</span></code></pre></div>
<pre><code>## variance: 19.76386</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print(mean(x_t))</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(var(x_t))</span></span></code></pre></div>
</div>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="using-inverse-transform-method.-1" class="section level3">
<h3>3.4: Using inverse transform method.</h3>
<p>Because I can’t find a command distribution which has density function <span class="math inline">\(g(x)\)</span> such that there is a constant <span class="math inline">\(c\)</span> satisfy <span class="math inline">\(f(x) \le cg(x)\)</span>, I don’t use acceptance-rejection method.</p>
<p>I use inverse transform method to solve the problem.</p>
<p><span class="math display">\[F(x) = P(X \le x) = \int_{-\infty}^x f(t)dt = \int_0^x \frac{t}{\sigma^2} e^{-t^2/(2\sigma^2)} dt
= \int_0^x -e^{-t^2/(2\sigma^2)} d(-t^2/(2\sigma^2))=(-e^t)|_0^{-x^2/(2\sigma^2)}=1-e^{-x^2/(2\sigma^2)}
\]</span> The inverse function is <span class="math inline">\(F^{-1}(x) = \left( -2\sigma^2 \log(1-x) \right)^{\frac{1}{2}}\)</span>.</p>
<p>The algorithm generating random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution is as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>, .<span class="dv">001</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 0.5</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="fl">0.5</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>, .<span class="dv">001</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma = 1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> Sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">1</span>) ) <span class="co"># generated sample mode</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>, .<span class="dv">001</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(Sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co">#the theoretical mode</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As can be seen from the above three graphs, the mode of the generated samples is close to the theoretical mode.</p>
</div>
<div id="generate-a-random-sample-of-size-1000-from-a-normal-location-mixture." class="section level3">
<h3>3.11: Generate a random sample of size 1000 from a normal location mixture.</h3>
<p>The code to generate a random sample of size 1000 from <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distribution with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span> is as follows.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.75</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2 </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.8</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.8</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.5</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p1=0.35</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.35</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> p1<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.35</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6OgA6Ojo6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmZmZmkLZmtv+QOgCQOjqQZgCQZjqQkGaQttuQ2/+2ZgC2Zjq2kDq2kGa22/+2/7a2/9u2///T09PbkDrbtpDb25Db/9vb////tmb/25D/27b//7b//9v///8Ksv2LAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHxklEQVR4nO2da2ObNhiFcep4l3Z1dkm9W2iXdWObSW3//z83xMXBNuhISEJCOs8n28Ev5okQkl4hshORkvn+AaFDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQIStBh+2HkL8c/Ntnqcf/6/tese19kNWPfNCUkQYfvRw8zryXc97Y8v8+TEfTPZvQwy+zN8+nLq78ie7ev3q+eqrK0W++Hv2SHYAQdf87e/DYmKBcqTi+btgi1Ugqx+WF7P/wdS/gVlN99/phl3z5XLw8Pj/tyRFAr5Kqw/Lu9+0tYe+/0J/oW9KOoP+rycRJn0rCgrpTkwkhLVTevn+vvPP6QZW+fXf1Ez4Ky1e+n48eu9tURlH9TGdqfL2KdY+t4FlQf13HXHviroPbS1F6ohgSdhJt7seV3+55j6/g+xeojLtr/v04JOvXEXry0zCIEDVfSF8LySAWpnWLXl/nDtjZ1qC5j7Ut3rSHflXTVAMSV9E1DMa8birvs/cVLJ/guQV+LYtKdHqOCel2N+nQ8bOv3otT0XjrBdx30uep1vu0OblzQ8VPXWW3qq15n9Yt4+c5Zd8O3IEdVqz0oCEBBAAoCBDPcESoUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAigJ+i4a6ZWhj8pwxpagopuqmTpbM5kcOgIOu7OWgq39yAFhI6g3g2BZTIn2ZJKUHbLDDvV2bjopun6qYOyv68JTVA3a9vdtG0pCxDkFwoCDAhyXynpRSy6+68LH1exAUHui5ReJb16am9uo6Ahmst8fWsWBQ3RNRTz9Z6Chjg3FPN7Chqk01I1hy4FzdO0DV/QuSk9epNx6oLmDncVnIJA8AUJGqukKWjecFfBKQgEpyAQPHxBMKuRuCCc1UhbkMKYdNqCFLIaaQtiCULgrEbignBWI3VBc4e7Cu5VUFU4LCwkF7GgJmVhmjCNWtDJgqPYBTWKDMabIxdU1nlBkyX3YhYkLuGNGYPJPxELOmxtrBcbs6CHdrnQKcUnhbRPJ8gsJRitoPy1DPAyf7nT7kVXgiyFc4H/y3xw4a6Cpy0IzxbzKOiwfd+NZJjdZmAiCB5s6iWIgsBXQxdUnWb1wyqMpkDHLChf78Wi8bls2Mxe4nDgtoKbg4VbzNwX+1CvCC7ralhMHKocLPxgdkFi9WJJV8Nm2md5gqpzSzyCQfawJZuJwwUKqhpCq6fjTlIFJV6CFLCYOIxTkMXE4QIFWbmjOWZBVhbgj1iQaEhbDAc3XKAgGw/ijFiQ9ALfcB4RGa+pIhYkefLQGfwcuIgFKQ2YwWIWsSA1RoqZfl4sVkHWwi1RUHWSrfe52cU+ZkHl6qkQvfl5EofLEyS66oXy/czGt0MtT5BoKApBZgvfRCyoK0G50ai9d0E4/Tj5iJo6qMDNRbVwaENHgm43MTmc0/VVDD1122JWY4GCMAvIangVtIQxaXeCmr6YtIZeQlbDmaC8XRdINsEs5RJUdpXzy0ZyFVtAVsORoN4whjQ3H35Ww5GgXg9splmuixNkaY1NClIKp7IhBYENKejy8ymToYISBBM6OuEGPrdxsMF3NQzCURAIl7ogODyVuiAYjoJAOAoC4SgIhKMgEI6CQDgKAuEoCIRLRdDkvFgigqbnxdIQZJDVSEOQQV4sDUEsQYjpebFEBE3Pi6UiaHI4CgLhUhHEhqIc1YbiwExBf4IMJy06ucxPOxJHgm4+cCdIuaGYqiCWIMRoQ/HqBB+ogwLCoSDPT8n0gv25+5FBQYCJgrw8oc4LM5Ugv9XyJZq/3I2QCbvBm1gJonvEFGR188kLoCQiCHdWDXYTgSCFrobBbiIQZDAXNg1BLEEInNUw2E0MgqZ3VlMRlCAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIMI+geixbNkJSKq19hcdY0ApsL5tM83m7swg67qqjLyS/TCw+U8oMwQhtHDAQU1Z/lj33YYBZBDVr7oxnY5uhStm6MyhCQ72WqOTvzX70ssIz1kHjRUTt8GURGor1L1JBL1/pP4VvRkHji+Y3PxwnAsCy+1UYeR1U3v251X2I43yCJOPYTclA5QONhIsTSC6oEBlPhaXX+8wmqAR1NBYkiyDA64gWK7WS2mcuQdL/vtIphjIpdRAgqN6DdJm2G1wLah/QLl1dT6mSlkdo9ySQHH3zL9CrqucpQWCFWHyZRxE65CWoSQ0HeIq9bMB/HzYUYYQW0JIW1VQvP6zCLILa0i8xUICuBo7QgLoapVKHpQ87qwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEDogsS0s94jKucndEHdU969EbogMbf5QX/6tz2CF3TKNe8+sUz4gkq16ZuuCF7QcfeT1yUJgxdUrP/Tm5ZqmdAFianNZo9+NSR0QXk9s9ljNR26IO9QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA/wF3lzOeJhqT3QAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From above figures with various <span class="math inline">\(p_1\)</span>, I find that when <span class="math inline">\(p_1&gt;0.75\)</span> or <span class="math inline">\(p_1&lt;0.35\)</span> it doesn’t produce bimodal mixtures. Therefore I conjecture when <span class="math inline">\(0.35 \le p_1 \le 0.75\)</span> it produce bimodal mixtures.</p>
</div>
<div id="write-a-program-to-simulate-a-compound-poissonlambda-gamma-process-y-has-a-gamma-distribution-estimate-the-mean-and-the-variance-of-x10-for-several-choices-of-the-parameters-and-compare-with-the-theoretical-values.-hint-show-that-ext-λtey_1-and-varxt-λtey_12-." class="section level3">
<h3>3.20: Write a program to simulate a compound Poisson<span class="math inline">\((\lambda)\)</span> –Gamma process (Y has a Gamma distribution) Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = λtE[Y_1^2 ]\)</span>.</h3>
<p>First, I prove that <span class="math inline">\(E[X(t)] = \lambda t E[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda t E[Y_1^2]\)</span></p>
<p><span class="math inline">\(proof:\)</span></p>
<p><span class="math display">\[\begin{align}
E[X(t)]= &amp; E[\Sigma_{i=1}^{N(t)}Y_i] = E[N(t)Y_1] = E\{E[N(t)Y_1|N(t)]\} =E\{N(t)E[Y_1]\}
= E[N(t)]E[Y_1]=\lambda tE[Y_1]\\

Var(X(t)) = &amp; E[X^2(t)]-E^2[X(t)] = E\{E[X^2(t)|N(t)]\}-E^2[X(t)]=E\{Var(X(t)|N(t))+E^2[X(t)|N(t)]\}-E^2[X(t)]\\
= &amp; E\{Var(\Sigma_{i=1}^{N(t)}Y_1|N(t))+E^2[\Sigma_{i=1}^{N(t)}Y_1|N(t)]\}-E^2[X(t)]
= E\{N(t)Var(Y_1)\}+N(t)^2 E^2[Y_1] \}-E^2[X(t)]\\
= &amp; E[N(t)]Var(Y_1)+E[N(t)^2]E^2[Y_1]-E^2[N(t)]E^2[Y_1]=E[N(t)]Var(Y_1)+Var(N(t))E^2[Y_1]\\
= &amp; \lambda t Var(Y_1)+\lambda t E^2[Y_1]=\lambda t E[Y_1^2]
\end{align}\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alpha = 1, beta = 1, lambda = 1   </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="dv">10</span>;alpha <span class="ot">&lt;-</span> <span class="dv">1</span>; beta <span class="ot">&lt;-</span><span class="dv">1</span> ; lambda <span class="ot">&lt;-</span><span class="dv">1</span> ;</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t[i], alpha, beta)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  x_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;mean:&quot;</span>,<span class="fu">mean</span>(x_t))</span></code></pre></div>
<pre><code>## mean: 10.00362</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;variance:&quot;</span>,<span class="fu">var</span>(x_t))</span></code></pre></div>
<pre><code>## variance: 19.90954</code></pre>
<p>The theoretical values of <span class="math inline">\(E[X(t)]\)</span> and <span class="math inline">\(Var(X(t))\)</span> is <span class="math inline">\(E[X(t)]=\lambda t E[Y_1]=\lambda t \alpha/\beta=\)</span> 10 , <span class="math inline">\(Var(X(t))=\lambda t E[Y_1^2]=\lambda t (\alpha^2+\alpha)/\beta^2=\)</span> 20.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alpha = 2, beta = 3, lambda = 4   </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="dv">10</span>;alpha <span class="ot">&lt;-</span> <span class="dv">2</span>; beta <span class="ot">&lt;-</span><span class="dv">3</span> ; lambda <span class="ot">&lt;-</span><span class="dv">4</span> ;</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t[i], alpha, beta)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  x_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;mean:&quot;</span>,<span class="fu">mean</span>(x_t))</span></code></pre></div>
<pre><code>## mean: 26.68806</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;variance:&quot;</span>,<span class="fu">var</span>(x_t))</span></code></pre></div>
<pre><code>## variance: 27.18655</code></pre>
<p>The theoretical values of <span class="math inline">\(E[X(t)]\)</span> and <span class="math inline">\(Var(X(t))\)</span> is <span class="math inline">\(E[X(t)]=\lambda t E[Y_1]=\lambda t \alpha/\beta=\)</span> 26.6666667 , <span class="math inline">\(Var(X(t))=\lambda t E[Y_1^2]=\lambda t (\alpha^2+\alpha)/\beta^2=\)</span> 26.6666667.</p>
<p>We can see that the estimate of the mean and the variance of X(10) for several choices of the parameters is close to the theoretical values.</p>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
</div>
<div id="write-a-function-to-compute-a-monte-carlo-estimate-of-the-beta3-3-cdf-and-use-the-function-to-estimate-fx-for-x-0.1-0.2-.-.-.-0.9.-compare-the-estimates-with-the-values-returned-by-the-pbeta-function-in-r." class="section level3">
<h3>5.4: Write a function to compute a Monte Carlo estimate of the <strong>Beta(3, 3)</strong> cdf, and use the function to estimate F(x) for x = 0.1, 0.2, . . ., 0.9. Compare the estimates with the values returned by the pbeta function in R.</h3>
<p>The density function of Beta Distribution is . The function to compute a Monte Carlo estimate of the <strong>Beta(3, 3)</strong> cdf as follows:$ x^{} (1-x)^{} $</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>MC_Beta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha=</span><span class="dv">3</span>, <span class="at">beta=</span><span class="dv">3</span>, <span class="at">n=</span><span class="dv">1000</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  thetahat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){ </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  thetahat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i]<span class="sc">*</span> (x[i]<span class="sc">*</span>u)<span class="sc">^</span>(alpha<span class="dv">-1</span>)<span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>x[i])<span class="sc">^</span>(beta<span class="dv">-1</span>) <span class="sc">/</span><span class="fu">beta</span>(alpha, beta))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  thetahat</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Using the function estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x= 0.1,0.2,\ldots ,0.9\)</span>. And compare with <strong>pbeta</strong> function.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">MC_Beta</span>(x),<span class="dv">5</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>theoretical <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x, <span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(estimate, theoretical,<span class="at">row.names =</span> x)</span></code></pre></div>
<pre><code>##     estimate theoretical
## 0.1  0.00858     0.00856
## 0.2  0.05792     0.05792
## 0.3  0.16268     0.16308
## 0.4  0.31569     0.31744
## 0.5  0.49543     0.50000
## 0.6  0.67336     0.68256
## 0.7  0.82131     0.83692
## 0.8  0.91891     0.94208
## 0.9  0.96093     0.99144</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, estimate,<span class="st">&#39;l&#39;</span>,<span class="at">col =</span><span class="dv">1</span>,)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, theoretical, <span class="at">col =</span><span class="dv">2</span>,)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">expression</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>), <span class="fu">expression</span>((X<span class="sc">+</span>X<span class="sc">^</span>{prime})<span class="sc">/</span><span class="dv">2</span>) )</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OmY6OpA6kLY6kNtmAABmADpmOgBmOjpmOmZmZmZmZpBmkJBmkLZmtv+QOgCQOmaQZgCQZmaQkLaQ2/+2ZgC2kJC225C22/+2/7a2///bkDrbtmbb25Db/7bb/9vb///fU2v/tmb/25D/27b//7b//9v///+KNufuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJj0lEQVR4nO2diZrbJhRGnXTsNOm4S7q4y6ibmjZjx/b7v11BO/KFXwaB0OQ/Xz9npmaQfAwX0NWyuRInm6V3IHcoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgZkGb1bCUoHmrm5/n5+fq3yUFLd02IIsLmrfK2aEgAAUBKAhAQQAKAlAQgIIAFASIKajYbLaXg5qM/uSo7jMWVD58VI621+t5/2iv7vMVdDkoLcdXT9dala26z1fQea961vH139f2Va4uC0GOnWAL0iwiqI9BlSpbdTkIcu3Dukexy+9y38V8+nHQqJcSNKm6kCo/fS933Smc3/duX6qg83fqM552dYAr63Z6+vK2TQ2LVC266vGnd53dah/6d272MbqgMs4oVmz167H6VKdd9dnOe2lTfZHLQY0a5Wbb//m189O/M97H1C3ION7rX+VpV8e2Qjm5HBpZG/G76IrUf1N/YfUI2+7C8B1jZ7uXKWTVxdoPc95v24+8eRxMuS4/dz/2RSpqNd0Ef7ALnTRjH3MSBBMMHZdDO7s67X7YtQOlLMgoUjeovoJhtUXSFlSFvY2l1bfVmVXiDEzHed9NP8s+uFoEDYs0IUntXl122IBuo3TMiWK7NWGzfXXejfK0awOq+iI6LRZBRpEmEldh2diD422M9hd03m8ePhaWT15vv3szylKjF1Q8/Ltvf24FFU2j294U6b6uG0HiF+krSEUz9bGtBzKuzWLV3GupOm9BXRc7qulN99nkFjQo0ve1pot1O1CKDd1TkG4eul3YZjjX+C2ojbF1Syqa4UcUNChS9uuepoJ2B0p5ReQpSDcP/bFtbcPYYpwY1Hw5TTto25MkaFCkmU82n+Gx3YlrN9MU9zGgBRWWttHsQR0HrGVmmCiq6Ft/DU2AFQQNi5T1HlXN7WiEoOE74330j0GWZnlPdcFLjcA/R9sPGcUE3/cRulj9NmTzp7fjWZBIbjPpu6iW855cfp32t75B+uubQcODGQ6Y/en5l59+m3goKVCQY5ifWF0Oh1xdeAkq+uWRYyo9rboXKahvQeEbTyxocBxxGqsO0rMj7IyvoHYSuI4YdHr7jZpHqtfXf7z7oH7+6qBiw3Fzs3ifUZCaQpfb7qinJ+kEvXm6HH5Sr6qLfXjzpH5Q/6rOVpi7L+2L91pMfQN6sepaakyqLnCYn9aAdeQpH/VrJeak//unGmNgfixgsaozLFKWBdcyz0H7O/JioqC6f6H8WMBiVY9kXoKM6kKWGkJebMDgnaaLGYI+VP8P5sd8Y5CeIRaPy3YxIS9m0L/TBGlD0Mc2SLvzY97DvKpWjWRBg5gk6NmFWVTIi43o02Gu2Y87P5bZPMjpZyToNi9WIaXDnILc+bHMBN2BnBdzpcNARcM9KYJb0PITRTkv5kiH2XDnx7xHsaDoPKjOW5CcF7Onw6y482MB86BwZhI0SHrZ02F23PmxgHlQOPN0MSMvZkuHOXDnx3xjkF7XBDNLkDbzYpZ02ISK2h0ZzTi9Be2WDtJyXkxOhznrcefHvLvY5JSLY8UfJkjMi8npMGc97vxYvCDdTgQc7WyWpUYw7vxYxCDdhMdoLSgwL9YC8mMxg3Td++MJCsqLtaD8mHcXc3eeBj2CRBQUkBdrgfmxyGsxNaeIKSgBsRerp90XFOSkG20t1b1EQWpmNTEGTajuJQq6m0iXIiTBdxQLObtjtqxGCgIF8ewOofTMZ3fkjo+giWd3TLoUYQaecZFA4gTpaZcihBPfj99B+0d9ZMBxqGXiieTBJPDjI6jQJ2VvXUccJl6KEEoKP57Hg6ojvsGXIgSSxI+nIJ1ccw3z0y5FCCONH68uttVHe87OpMqkSxGCSOTHM7P66umOI9Nh27WQyk/0tVik6pL5WamgdH68BMFLMufcrsD4ZJioeAjCl2TOud1bUurxTfuASzLn3O4Naf14zoPQJZkzbndMYj8BLch5SeZ82x2R2o9/DJrhkkwPkvvxHcVmuSTzftL7Wdc8aAE/qxK0hJ/UgszjvXeRdHrYs5oWtIye9Qhays9aBC3mZyWClvOzCkELheea/AUtqid/QQvryV3Q4nryFpSBnqwF5aAnmqDwszuyaD7XbM/uyEVPJEGhufl89EQSFHZ2R0568mtBN1eAL02sGORzdsft9fEZEGkUu/vsjizlaHKYB2UrR7O0oKzlaGILcl2KkNuAJbKeg/YLsXQXyx4KAmS7WM2FxRarqyGGoAlLjeANLVJsriomLFaDN7RqQWxBCLxYDd7QugXhxWrwhlYuKP6GKCjHYpGrmHVDFJRjschVvGwoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQILag4+Aqz9EjZGzFNJZLi41i+g7h8p1GjGL6dtIB1+FGFqRvfd0+8mP8CBlLsep3+aCuUUw/ykq+V41RrNS/BBiKK6jOgzQ3tRo/QsZS7NrcJAPUVv8Ca6tvZxNwI++4ggQnR+G66nGx8uEXSZBRzH77a6NY7oKqT2FkGQvhOx8VU7+KMcgodnz9116OaGZteXex4/AZ1fX/kT6TWUx3EVGQUazc2B4hNdroOP7fSWJB8vMMzGLWG2SYgl7dNE6xNt1ibQ9Wn0LaLmbJyBrFql9wF6tjjHRzdLM268gwkaRB2vZkJ6NY8xgMIWwYxWoBUqg2i9108jtJOMwLDy0Ui2nEFmQUq081kbqYMLcIuOdPwomiIxKMJ4qWmbQ5A1RF5IeBGMXyjkFVh9G7qoeb8SNkLMUqLEsNo9jRunAxihXWYpPgYhVAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFATIXZA+USzwqXlh5C6ofezZYuQuSJ8PPeVB79HIXtC1sFyxkoj8BYWcJj8D2Qu6HN4HPZYylOwFlQ//iaeypiJ3Qfp06LAnmwaSu6CiOht6wTCdu6DFoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8Dwc7InXuukfUAAAAASUVORK5CYII=" /><!-- --></p>
<p>We can find the MC estimate value is close to the value generate from <strong>pbeta</strong> function in R.</p>
</div>
<div id="the-rayleigh-density-is" class="section level3">
<h3>5.9: The Rayleigh density is</h3>
<p><span class="math display">\[f(x) = \frac{x}{\sigma^2} e^{-x^2/(2 \sigma^2)}, x\ge 0, \sigma&gt;0 \]</span> Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span> ?</p>
<p>I use inverse transform method to solve the problem.</p>
<p><span class="math display">\[F(x) = \int_0^x \frac{t}{\sigma^2} e^{-t^2/(2\sigma^2)}=1-e^{-x^2/(2\sigma^2)}\]</span></p>
<p><span class="math display">\[F^{-1}(u) = \left( -2\sigma^2 \log(1-u) \right)^{\frac{1}{2}},0&lt;u&lt;1\]</span>.</p>
<p><span class="math display">\[F^{-1}(1-u)= \left( -2\sigma^2 \log(u) \right)^{\frac{1}{2}},0&lt;u&lt;1 \]</span> The function to generate samples from a Rayleigh(σ) distribution, using antithetic variables, as follows:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">sigma =</span> <span class="dv">1</span>,<span class="at">antithetic =</span> <span class="cn">TRUE</span>){</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) X <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U[<span class="dv">1</span><span class="sc">:</span>(n)]))<span class="sc">*</span>sigma <span class="sc">+</span>  <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U[<span class="dv">1</span><span class="sc">:</span>(n)]))<span class="sc">*</span>sigma <span class="cf">else</span> X <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))<span class="sc">*</span>sigma <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))<span class="sc">*</span>sigma</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  X<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> <span class="fu">sampling</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">sampling</span>(<span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.9744065</code></pre>
<p>We can find the the percent reduction in variance achieve 97%.</p>
</div>
<div id="find-two-importance-functions-f_1-and-f_2-that-are-supported-on-1infty-and-are-close-to" class="section level3">
<h3>5.13: Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to</h3>
<p><span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
<p>The importance function that are supported on <span class="math inline">\((1, \infty)\)</span> are Exponential Distribution and Normal Distribution.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span>  <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(g<span class="sc">/</span>f[<span class="dv">1</span>](x)<span class="sc">==-</span>x<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(g<span class="sc">/</span>f[<span class="dv">2</span>](x)<span class="sc">==</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>e<span class="sc">^</span>{(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>x}))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The exponential distribution has the smaller variance. The reason is that <span class="math inline">\(g/f_2\)</span> is closer to constant which means <span class="math inline">\(f_2(x)\)</span> is closer to <span class="math inline">\(g(x)\)</span>.</p>
</div>
<div id="obtain-a-monte-carlo-estimate-of" class="section level3">
<h3>5.14 Obtain a Monte Carlo estimate of</h3>
<p><span class="math display">\[\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}}e^{-x^2/2}dx\]</span> by importance sampling.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) <span class="co">#using normal distribution f1 =1/sqrt(2*pi) *exp(-x^2/2)</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>) <span class="co"># g/f = x^2 (x&gt;1)</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)<span class="sc">/</span><span class="fu">sqrt</span>(m)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using exponential distribution f2 = e^(-x)</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)<span class="sc">/</span><span class="fu">sqrt</span>(m)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">est=</span><span class="fu">round</span>(est,<span class="dv">5</span>), <span class="at">sd=</span><span class="fu">round</span>(sd,<span class="dv">5</span>))</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">f1</th>
<th align="center">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="center">0.40664</td>
<td align="center">0.40248</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="center">0.01143</td>
<td align="center">0.00586</td>
</tr>
</tbody>
</table>
<p>From the result we can find the exponential distribution has the smaller variance, which is consistent with 5.14.</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R). If we obtain the powers for two methods under a particular</p>
<p>simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<ul>
<li><p>I What is the corresponding hypothesis test problem?</p></li>
<li><p>I What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>I Please provide the least necessary information for hypothesis testing.</p></li>
</ul>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
</div>
<div id="suppose-a-95-symmetric-t-interval-is-applied-to-estimate-a-mean-but-the" class="section level3">
<h3>6.5: Suppose a 95% symmetric t-interval is applied to estimate a mean, but the</h3>
<p>sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>If X 1 ,…,X n is a random sample from a chisq(2) distribution, the mean value is 2. The test statistic <em>t</em> = <span class="math inline">\(\frac{\bar{x}-2}{s} \sim t(2)\)</span>, where s is the variance of sample, the t interval is <span class="math inline">\((\bar{x}-\frac{\sigma_x}{\sqrt{n-1}} t_{1-\alpha/2}(2),\bar{x}+\frac{\sigma_x}{\sqrt{n-1}} t_{1-\alpha/2}(2))\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> U <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  L[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span>(<span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  U[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span>(<span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(L<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> U<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9237</code></pre>
<p>Compare the t-interval results with the simulation results in Example 6.4,we find that this coverage probability of the t-interval is smaller.</p>
</div>
<div id="a-use-monte-carlo-simulation-to-investigate-whether-the-empirical-type-i-error-rate-of-the-t-test-is-approximately-equal-to-the-nominal-significance-level-alpha-when-the-sampled-population-is-non-normal.-the-t-test-is-robust-to-mild-departures-from-normality.-discuss-the-simulation-results-for-the-cases-where-the-sampled-population-is-i-χ21-ii-uniform02-and-iii-exponentialrate1.-in-each-case-test-h0-µ-µ0-vs-h0-µ-µ0-where-µ0-is-the" class="section level3">
<h3>6.A: Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : µ = µ0 vs H0 : µ ̸= µ0, where µ0 is the</h3>
<p>mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
<ol style="list-style-type: lower-roman">
<li>The mean values of chisq(1),Uniform(0,2) and Exponential(1) are all 1.</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># null hypothesis!</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span>; n <span class="ot">&lt;-</span> <span class="dv">20</span>; <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df =</span><span class="dv">1</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  ttest1 <span class="ot">&lt;-</span>  <span class="fu">t.test</span>(x1, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  ttest2 <span class="ot">&lt;-</span>  <span class="fu">t.test</span>(x2, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  ttest3 <span class="ot">&lt;-</span>  <span class="fu">t.test</span>(x3, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  p1[i] <span class="ot">&lt;-</span> ttest1<span class="sc">$</span>p.value</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  p2[i] <span class="ot">&lt;-</span> ttest2<span class="sc">$</span>p.value</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  p3[i] <span class="ot">&lt;-</span> ttest3<span class="sc">$</span>p.value</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha), <span class="fu">mean</span>(p2 <span class="sc">&lt;</span> alpha), <span class="fu">mean</span>(p3 <span class="sc">&lt;</span> alpha))</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>m)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(p.hat, se.hat,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;(i)χ2(1)&quot;</span>, <span class="st">&quot;(ii)Uniform(0,2)&quot;</span>, <span class="st">&quot;(iii)Exponential(1)&quot;</span>))</span></code></pre></div>
<pre><code>##                      p.hat      se.hat
## (i)χ2(1)            0.0133 0.001145561
## (ii)Uniform(0,2)    0.0486 0.002150303
## (iii)Exponential(1) 0.0189 0.001361719</code></pre>
<p>The observed Type I error rate of chisq2(1), Uniform(0,2), and Exponential(1) are 0.0133, 0.0486, 0.0189 and the standard error of the estimate are 0.001145561, 0.002150303, 0.001361719. The estimates of Type I error probability are vary ,but should be close to the nominal rate <span class="math inline">\(\alpha\)</span>= 0.05. Howere ,we find that only the Type I error probability of uniform(0,2) is close to 0.05. When n is large enough , the Type I error of chisq2(1) and Exponential(1) will close to 0.05.</p>
</div>
<div id="simulation-setting-with-10000-experiments-say-0.651-for-one-method-and-0.676-for-another-method.-we-want-to-know-if-the-powers-are-different-at-0.05-level." class="section level3">
<h3>simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</h3>
<ul>
<li><p>I What is the corresponding hypothesis test problem?</p></li>
<li><p>I What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>I Please provide the least necessary information for hypothesis testing.</p></li>
</ul>
<p>(1)if we make powers for two methods under a particular simulation is p1 and p2,the corresponding hypothesis test problem is <span class="math display">\[H_0 :p_1=p_2 \quad vs \quad H_1:p_1 \not=p_2\]</span></p>
<p>(2)In my opinion,we can use Z-test, paired-t test or McNemar test, in Z-test we can make <span class="math inline">\(Z_i = Y_i − X_i\)</span>,paired-t test and McNemar test are used for the analysis of paired count data, and they can analyze whether the results before and after the experiment are different.However,two-sample t-test requires the samples to be independent. Obviously, the samples in the question are the same set of samples, which cannot be independent of each other,thus we shouldn’t choose it.</p>
<p>(3)To test my hypothesis, we need to know Sample mean,Sample var,Sample size etc, .</p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>6.C Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1,d} = E[(X-\mu)^T \Sigma^{-1}(Y-\mu)]^3.
\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewwness statistic is <span class="math display">\[
b_{1,d}= \frac{1}{n^2} \sum_{i,j=1}^{n}((X_i-\bar{X})^T \hat{\Sigma}^{-1} (X_j-\bar{X}))^3,
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquqred with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
<p>Example 6.8</p>
<p>The hypotheses are <span class="math display">\[
H_0 : \sqrt{\beta_{1,d}} =0; \quad H_1 : \sqrt{\beta_{1,d}} \ne 0,
\]</span> where the sampling distribution of the skewness statistic is derived under the assumption of normality. Assess the Type I error rate for a skewness test of normality at <span class="math inline">\(\alpha\)</span> = 0.05 based on the asymptotic distribution of <span class="math inline">\(\sqrt{b_1}\)</span> for sample sizes n = 10, 20, 30, 50, 100, and 500.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># genrate multi-normal distribution</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co"># sample size</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># dimension</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>cv_U <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>cv_L <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.025</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>mul_sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(x[,<span class="dv">1</span>]),<span class="fu">mean</span>(x[,<span class="dv">2</span>])),n,<span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  x_ <span class="ot">&lt;-</span> x<span class="sc">-</span>x_bar</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  sigma_hat <span class="ot">&lt;-</span> <span class="fu">var</span>(x)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="co"># MLE</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">mean</span>((x_ <span class="sc">%*%</span> <span class="fu">solve</span>(sigma_hat) <span class="sc">%*%</span> <span class="fu">t</span>(x_))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">*</span>b<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>((<span class="fu">mul_sk</span>(x) <span class="sc">&lt;=</span>cv_L) <span class="sc">|</span>( <span class="fu">mul_sk</span>(x)<span class="sc">&gt;=</span> cv_U))</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p.reject)</span></code></pre></div>
<pre><code>## [1] 0.050 0.055 0.057 0.044 0.054 0.050</code></pre>
<p>Example 6.10</p>
<p>For this experiment, the significance level is <span class="math inline">\(\alpha\)</span> = 0.1 and the sample size is n = 30. The skewness statistic mul_sk is implemented in Example 6.8.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2500</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#critical value for the skewness test</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>cv_U <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>cv_L <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(alpha<span class="sc">/</span><span class="dv">2</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for each replicate</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e)))</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(a<span class="sc">==</span><span class="dv">0</span>){x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n,mu,sigma1)}</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(a<span class="sc">==</span>n){x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n,mu,sigma2)}</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {x1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n<span class="sc">-</span>a,mu,sigma1)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>          x2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(a,mu,sigma2)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>          x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1,x2)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">mul_sk</span>(x) <span class="sc">&lt;=</span> cv_L <span class="sc">|</span> <span class="fu">mul_sk</span>(x) <span class="sc">&gt;=</span>cv_U )</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co">#add standard errors</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7,7.8,7.9，and 7.B(pages 213, Statistical Computing with R)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>7.7</h3>
<p>Referto Exercise7.6. Efron and Tibshirani discuss the following example [84, Ch.7]. The ﬁve-dimensional scores data have a 5×5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigen values <span class="math inline">\(\lambda_1&gt; \cdots&gt;\lambda5\)</span>. In principal components analysis, <span class="math display">\[ 
 \theta=\frac{\lambda_1}{\sum_{j=1}^{5} \lambda_j}
\]</span></p>
<p>measures the proportion of variance explained by the ﬁrst principal component. Let <span class="math inline">\(\hat\lambda_1&gt; \cdots&gt;\hat\lambda5\)</span> be the eigen values of <span class="math inline">\(\hat\Sigma\)</span>,where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[ 
 \hat{\theta}=\frac{\hat{\lambda_1}}{\sum_{j=1}^{5} \hat{\lambda_j}}
\]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> (eig<span class="sc">$</span>value[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> scor[i,]</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  sigma.i <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.i)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  theta[b] <span class="ot">&lt;-</span> (eig<span class="sc">$</span>values[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>bias.theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta.hat<span class="sc">-</span>theta)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>se.theta <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">bias =</span> bias.theta, <span class="at">se=</span>se.theta))</span></code></pre></div>
<pre><code>## $bias
## [1] 0.002039819
## 
## $se
## [1] 0.04948062</code></pre>
<p>The results of bootstrap are as above.</p>
</div>
<div id="section-1" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise7.7.Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> (eig<span class="sc">$</span>value[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  sigma.i <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.i)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  theta[i] <span class="ot">&lt;-</span> (eig<span class="sc">$</span>values[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>bias.theta <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta)<span class="sc">-</span>theta.hat)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>se.theta <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta<span class="sc">-</span><span class="fu">mean</span>(theta))<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">bias =</span> bias.theta, <span class="at">se=</span>se.theta))</span></code></pre></div>
<pre><code>## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<p>The results of jackknife are as above. Compare with Bootstrap, it has smaller bias but higer variance.</p>
</div>
<div id="section-2" class="section level3">
<h3>7.9</h3>
<p>Refer to Exercise7.7. Compute 95% percentile and BCa conﬁdence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> (eig<span class="sc">$</span>value[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>theta.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(x,ind){</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  sigma.i <span class="ot">&lt;-</span> <span class="fu">cov</span>(x[ind,])</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.i)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  eig<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eig<span class="sc">$</span>values)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(scor,<span class="at">statistic =</span> theta.boot, <span class="at">R =</span> <span class="dv">100</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 100 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5193,  0.7258 )   ( 0.5177,  0.7258 )  
## Calculations and Intervals on Original Scale
## Some percentile intervals may be unstable
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="b" class="section level3">
<h3>7.B</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">=</span>ci.basic<span class="ot">=</span>ci.perc<span class="ot">=</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">=</span><span class="cf">function</span>(x){ </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  x.bat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> <span class="fu">mean</span>((x <span class="sc">-</span> x.bat)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">=</span> <span class="fu">mean</span>((x <span class="sc">-</span> x.bat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (m1<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>boot.median<span class="ot">=</span><span class="cf">function</span>(x,ind) <span class="fu">sk</span>(x[ind])</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># normal populations</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.median,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">=</span><span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">=</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">=</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">=</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>p1.norm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu<span class="sc">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>p1.basic<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu<span class="sc">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>p1.perc<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu<span class="sc">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(p1.norm,p1.basic,p1.perc,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</span></code></pre></div>
<pre><code>##              p1.norm p1.basic p1.perc
## coverage       0.916    0.922   0.942
## on the left    0.049    0.048   0.035
## on the right   0.035    0.030   0.023</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># χ2(5) distributions</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">=</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.median,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">=</span><span class="fu">boot.ci</span>(de,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">=</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">=</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">=</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>p2.norm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu1<span class="sc">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu1),<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu1),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu1))</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>p2.basic<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu1<span class="sc">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu1),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu1),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu1))</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>p2.perc<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu1<span class="sc">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu1),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu1),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu1))</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(p2.norm,p2.basic,p2.perc,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</span></code></pre></div>
<pre><code>##              p2.norm p2.basic p2.perc
## coverage       0.779    0.766   0.762
## on the left    0.025    0.042   0.000
## on the right   0.196    0.192   0.238</code></pre>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-3" class="section level3">
<h3>8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
<p>I generate two normal sample with 12 samples. They are iid. The hypothes is <span class="math display">\[
H_0: \text{the bivariate Spearman rank is not correlation}
\]</span> <span class="math display">\[
H_0: \text{the bivariate Spearman rank is correlation}
\]</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span>(<span class="dv">1</span><span class="sc">:</span>R)){</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">12</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  t[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0,t) <span class="sc">&gt;=</span> t0)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1,p2)</span></code></pre></div>
<pre><code>## [1] 0.8170000 0.6551967</code></pre>
<p>The significance level of the permutation test of the bivariate Spearman rank correlation test is <code>p1</code>, the bivariate Spearman rank correlation test is <code>p2</code>. They both bigger than <span class="math inline">\(\alpha=0.05\)</span>. So is null hypothesis is accept. What’s more ,we have p1 &gt; p2,which means significance level of the permutation test is more obvious.</p>
</div>
<div id="section-4" class="section level3">
<h3></h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul>
<p>In the first case, I set the two variable ,x and y, have 1 and 1.5 variance,respectively.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN) </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z);</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;=</span> n1); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>(i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)}</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> p4 <span class="ot">&lt;-</span> p5 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>  z1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1, y1)</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z1,N,k)<span class="sc">$</span>p.value</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z1,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x1,<span class="at">y=</span>y1,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>pow1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p1<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>pow1</span></code></pre></div>
<pre><code>## [1] 0.285 0.362 0.853</code></pre>
<p>When unequal variances and equal expectations, the performance of three methods are all good, but the ball method is best, NN method is worst.</p>
<p>In the second case, I set the two variable ,x and y, have 0 and 0.5 mean ,1 and 1.5 variance,respectively.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  z2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x2, y2)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z2,N,k)<span class="sc">$</span>p.value</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z2,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x2,<span class="at">y=</span>y2,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>pow2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p2<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>pow2</span></code></pre></div>
<pre><code>## [1] 0.542 0.872 0.954</code></pre>
<p>When unequal variances and unequal expectations, the performance of three methods are all good, but the ball method is best, NN method is worst.</p>
<p>In the third case, I set y is the mixture of two normal distributions with 0,5 and 1 mean ,2 and 3 variance,respectively.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Non-normal distributions: t distribution with 1 df，bimodel distribution</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(<span class="dv">100</span>,<span class="at">df=</span><span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>()</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>      r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">1</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">&lt;-</span><span class="fu">ifelse</span>(r<span class="sc">==</span><span class="dv">0</span>,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">2</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  y3<span class="ot">&lt;-</span><span class="fu">matrix</span>(y,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  z3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x3, y3)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z3,N,k)<span class="sc">$</span>p.value</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z3,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x3,<span class="at">y=</span>y3,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>pow3 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p3<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>pow3</span></code></pre></div>
<pre><code>## [1] 0.616 0.721 0.662</code></pre>
<p>When non-normal distributions: t distribution with 1 df，bimodel distribution, the performance of three methods are almost same, but the energy method is best, NN method is worst.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unbalanced samples</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>n3<span class="ot">&lt;-</span><span class="dv">25</span>;n4<span class="ot">&lt;-</span><span class="dv">250</span>;n5 <span class="ot">&lt;-</span> n3<span class="sc">+</span>n4;N1<span class="ot">&lt;-</span><span class="fu">c</span>(n3,n4)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  x4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  y4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  z4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x4, y4)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z4,N1,k)<span class="sc">$</span>p.value</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z4,<span class="at">sizes=</span>N1,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x4,<span class="at">y=</span>y4,<span class="at">R=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>pow4 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p4<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>pow4</span></code></pre></div>
<pre><code>## [1] 0.085 0.111 0.840</code></pre>
<p>When unbalanced samples, the performance of three methods are far different. NN method and energy method is very bad, but the ball method is good.</p>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</li>
<li>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2.</li>
</ul>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-5" class="section level3">
<h3>9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and com- pare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy<span class="math inline">\((\theta,\eta)\)</span> distribution has density function</p>
<p>使用建议分布选正态分布<span class="math inline">\(N(X_t,\sigma^2)\)</span>实现随机游动形式的Metropolis样本生成器。 此时 <span class="math display">\[
r(x_t,y)=\frac{f(Y)}{f(X_t)} =\frac{1+x_t^2}{1+y^2}
\]</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span>N)) {</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (u[i] <span class="sc">&lt;</span> ((<span class="dv">1</span><span class="sc">+</span>x[i<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>            k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>,  <span class="dv">4</span>)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="co"># no.reject &lt;- data.frame(theta=theta,no.reject=c(rw1$k, rw2$k, rw3$k, rw4$k))</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="co"># # knitr::kable(no.reject)</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="co"># no.reject</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    refline <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,  rw4<span class="sc">$</span>x)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></span></code></pre></div>
<ul>
<li>Quantiles of the generated samples</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    Q <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x, rw4<span class="sc">$</span>x)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    mc <span class="ot">&lt;-</span> rw[<span class="dv">501</span><span class="sc">:</span>N, ]</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    Qrw <span class="ot">&lt;-</span> <span class="fu">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, a))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    qq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(qq) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=1&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(qq) <span class="co">#latex format</span></span></code></pre></div>
<p>可以看到，<span class="math inline">\(\sigma^2=1\)</span>时的分位数与真实值比较接近。</p>
</div>
<div id="section-6" class="section level3">
<h3>9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1},\ x=0,1,\ldots,n,0 \le y \le 1.
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f (x, y)\)</span>.</p>
<p>条件分布： <span class="math display">\[
f(x|y) \sim B(n,y)
\]</span> <span class="math display">\[
f(y|x) \sim Beta(x+a,n-x+b)
\]</span></p>
<pre><code>## Means:  1.01 0.5</code></pre>
<pre><code>## Standard errors:  0.81 0.29</code></pre>
<pre><code>## Correlation coefficients:  0.71</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="gelman-rubin-method-to-monitor-convergence-of-the-chain-and-run-the-chain-until-it-converges-approximately-to-the-target-distribution-according-to-hatr1.2." class="section level2">
<h2>Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2.\)</span></h2>
<div id="section-7" class="section level3">
<h3></h3>
<div id="section-8" class="section level4">
<h4>9.3</h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="dv">2</span>    <span class="co">#parameter of proposal distribution</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate the chains</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma, x0[i], n)<span class="sc">$</span>x</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co">#    par(mfrow=c(2,2))</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">col=</span>i)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看到<span class="math inline">\(\sqrt{\hat{R}}\)</span>并未小于1.2，此时的Metropolis-Hastings链并未收敛。</p>
</div>
<div id="section-9" class="section level4">
<h4>9.8</h4>
</div>
</div>
</div>
<div id="r-libraryr2openbugs-n---1e4-j---nrowschools-y---x-1-sigma.y---x-2-data---list-n-j-x1-x2-inits---function-listtheta-rnormj-0-100-mu.theta-rnorm1-0-100-sigma.theta-runif1-0-100-bugsdtainits-parameters-n.chains-3-n.iter-n-codapkgtrue-librarycoda-mymodel.coda---read.bugsschools.sim" class="section level1">
<h1><code>{r} # library(R2OpenBUGS) # N &lt;- 1e4 # J &lt;- nrow(schools) # y &lt;- X[ ,1] # sigma.y &lt;- X[ ,2] # data &lt;- list (&quot;N&quot;, &quot;J&quot;, &quot;x1&quot;, &quot;x2&quot;) # inits &lt;- function(){ #   list(theta = rnorm(J, 0, 100), mu.theta = rnorm(1, 0, 100), #     sigma.theta = runif(1, 0, 100)) # } #  # bugs(dta,inits = ,parameters = ,n.chains = 3, n.iter = N, codaPkg=TRUE) #  # library(coda) # myModel.coda &lt;- read.bugs(schools.sim) #</code></h1>
</div>
<div id="rechofalse-plot-the-sequence-of-r-hat-statistics-rhat---rep0-n-for-j-in-b1n-rhatj---gelman.rubinpsi1j-plotrhatb1n-typelylim-c03-xlab-ylabr-ablineh1.2-lty2" class="section level1">
<h1><code>{r,echo=FALSE} #      #     #plot the sequence of R-hat statistics #     rhat &lt;- rep(0, n) #     for (j in (b+1):n) #         rhat[j] &lt;- Gelman.Rubin(psi[,1:j]) #     plot(rhat[(b+1):n], type=&quot;l&quot;,ylim = c(0,3) ,xlab=&quot;&quot;, ylab=&quot;R&quot;) #     abline(h=1.2, lty=2) #</code></h1>
<p>未做出来。</p>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</li>
<li>Suppose <span class="math inline">\(T_1,\ldots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_i I(T_i \le \tau) + \tau I(T_i &gt; \tau),i = 1, \ldots , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</li>
</ul>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="section-10" class="section level3">
<h3>11.3</h3>
<div id="a" class="section level4">
<h4>(a)</h4>
<p>防止计算时溢出,计算<span class="math inline">\(\frac{\| \boldsymbol{a} \|^{2k+2}}{(2k+1)(2k+2)}\)</span>时，先计算其对数值再用exp计算，同样使用lgamma函数计算<span class="math inline">\(\frac{ \Gamma(\frac{d+1}{2}\Gamma(k+\frac{3}{2})} {k!\ \Gamma(k+d/2+1)}\)</span>,。</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>f_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k,d,a) {</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">norm</span>(<span class="fu">as.matrix</span>(a),<span class="st">&quot;F&quot;</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k)<span class="sc">-</span><span class="fu">lgamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span><span class="dv">1</span>)) </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,d)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">f_k</span>(<span class="dv">1</span>,d,a)</span></code></pre></div>
<pre><code>## [1] -2.190891</code></pre>
</div>
<div id="b-1" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>f_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(d,a) {</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  sk<span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">norm</span>(<span class="fu">as.matrix</span>(a),<span class="st">&quot;F&quot;</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k)<span class="sc">-</span><span class="fu">lgamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(sk) <span class="sc">&lt;</span> .Machine<span class="sc">$</span>double.eps) {<span class="cf">break</span>}</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> s<span class="sc">+</span>sk</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">sum =</span> s, <span class="at">k =</span> k))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,d)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="fu">f_sum</span>(d,a)</span></code></pre></div>
<pre><code>##       sum         k 
## -1.071858 95.000000</code></pre>
</div>
<div id="c" class="section level4">
<h4>(c)</h4>
<p>使用(b)中函数，当<span class="math inline">\(d = 2, \boldsymbol{a}=(1,2)^T\)</span>时，计算和。</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">f_sum</span>(d,a)</span></code></pre></div>
<pre><code>##        sum          k 
## -0.3025684 24.0000000</code></pre>
<p>迭代24次后达到机器精度，和为-0.3025684.</p>
</div>
</div>
<div id="section-11" class="section level3">
<h3>11.4</h3>
<p>与11.5 比较结果</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>root<span class="ot">=</span><span class="cf">function</span>(k){</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">=</span><span class="cf">function</span>(a){</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>((k<span class="dv">-1</span>)<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">=</span><span class="cf">function</span>(a){</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(k<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">s1</span>(a)<span class="sc">-</span><span class="fu">s2</span>(a)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">uniroot</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">1e-6</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">1e-6</span>))<span class="sc">$</span>root)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">root</span>(k)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614517  1.625406
##  [8]  1.634409  1.642026  1.648511  1.654174  1.659121  1.663442  1.667288
## [15]  1.670736  1.673841  1.676589  1.679139  1.681461  4.795831  4.898978
## [22]  4.999999  9.999999 22.360679 31.622776</code></pre>
</div>
<div id="section-12" class="section level3">
<h3>11.5</h3>
<p><span class="math display">\[
\frac{\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\left (1+\frac{u^2}{k-1}\right )^{-k/2}
\]</span> 是自由度为<span class="math inline">\(k-1\)</span>的t分布的概率密度函数。所以<span class="math inline">\(2\frac{\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}\left (1+\frac{u^2}{k-1}\right )^{-k/2}=2(P(t(k-1)&lt;c_{k-1})-1/2)\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>find_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S1 &lt;-function(a){</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   jifen = integrate(function(u) { (1 + u^2/(k-1) )^(-k/2)},lower = 0, upper = sqrt(a^2*(k-1)/(k-a^2)) )$value</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   2* exp( lgamma(k/2)-lgamma( (k-1)/2) )/ sqrt(  pi*(k-1) ) * jifen</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S2 &lt;-function(a){</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   jifen = integrate(function(u) { (1+u^2/k)^(-(k+1)/2)},lower = 0, upper = sqrt(a^2*k/(k+1-a^2)) )$value</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   2* exp( lgamma( (k+1)/2 )-lgamma(k/2) )/ sqrt( pi*k ) * jifen</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">*</span>( <span class="fu">pt</span>( <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>) <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">*</span>( <span class="fu">pt</span>( <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k) <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">S1</span>(a)<span class="sc">-</span><span class="fu">S2</span>(a)</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">uniroot</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">1e-6</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">1e-6</span>))<span class="sc">$</span>root)</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">find_a</span>(k)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614517  1.625406
##  [8]  1.634409  1.642026  1.648511  1.654174  1.659121  1.663442  1.667288
## [15]  1.670736  1.673841  1.676589  1.679139  1.681461  4.795831  4.898978
## [22]  4.999999  9.999999 22.360679 31.622776</code></pre>
<p>结果与11.4一致。</p>
</div>
<div id="em" class="section level3">
<h3>EM</h3>
<p>Suppose <span class="math inline">\(T_1,\ldots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_i I(T_i \le \tau) + \tau I(T_i &gt; \tau),i = 1, \ldots , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
<p>小于1的7个数记为<span class="math inline">\(X_1,\ldots,X_7\)</span>,等于1的3个数几位<span class="math inline">\(Z_1,Z_2,Z_3\)</span></p>
<ul>
<li><p>MLE求解：<span class="math inline">\(X_1,\ldots,X_7\)</span>是服从参数为<span class="math inline">\(\lambda\)</span>的指数分布，<span class="math inline">\(Z_1,Z_2,Z_3\)</span>的概率为<span class="math inline">\(\int_1^{\infty}\lambda e^{-\lambda x}dx=e^{-\lambda}\)</span>. 则似然函数为<span class="math inline">\(L(\lambda)=\lambda^7 e^{-\lambda(X_1+\cdots+X_7)}(e^{-\lambda})^3\)</span>.其对数似然函数为<span class="math inline">\(LL(\lambda) = 7log\lambda-\lambda \sum_i X_i -3\lambda\)</span>. 易得最大值<span class="math inline">\(\hat{\lambda} = \frac{7}{\sum_i X_i +3}=28/27\)</span>。</p></li>
<li><p>EM求解： E步：</p></li>
</ul>
<p><span class="math inline">\(Z|X,\lambda^{i} \sim \lambda e^{-\lambda z}/e^{-\lambda},z\ge 1. \ E[Z|X,\lambda^i]= \frac{1}{e^{-\lambda}} \int_1^{\infty}\lambda^i e^{-\lambda^ix}dx=\frac{\lambda^i+1}{\lambda^i}\)</span> 从而<span class="math inline">\(Q(\lambda,\lambda^i)=E_z[logL(\lambda;X,Z)|X,\lambda^i]= 10log\lambda-\lambda \sum_i X_i - \lambda \sum_iZ_i= 10log\lambda-\lambda \sum_i X_i - \frac{\lambda^i+1}{\lambda^i}3\lambda\)</span>.</p>
<p>M步:</p>
<p>对<span class="math inline">\(Q(\lambda,\lambda^i)\)</span>求最大值得<span class="math inline">\(\lambda^{i+1} = \frac{10}{\sum_i X_i+\sum_iZ_i}=\frac{10}{\sum_iX_i+3+3/\lambda^i}\)</span>.当<span class="math inline">\(\lambda\)</span>收敛时，<span class="math inline">\(\lambda = \frac{10}{\sum_i X_i+3+3/\lambda}\)</span>,解得<span class="math inline">\(\hat\lambda = \frac{7}{\sum_i X_i +3}=28/27\)</span>.与MLE的结果相同。</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># \sum_i X_i+3 = \sum_i Y_i</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.91</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> lambda0 <span class="ot">=</span> <span class="dv">1</span> <span class="co">#inital est. for lambdas</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">=</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>){</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">=</span> <span class="fu">rep</span>((lambda<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>lambda,<span class="dv">3</span>) <span class="co">#E step</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(X)<span class="sc">+</span><span class="fu">sum</span>(Z)) <span class="co">#M step</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda<span class="sc">-</span>lambda0) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  lambda0 <span class="ot">=</span> lambda</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">est =</span> lambda,<span class="at">true =</span><span class="dv">28</span><span class="sc">/</span><span class="dv">27</span>)</span></code></pre></div>
<pre><code>##      est     true 
## 1.037037 1.037037</code></pre>
<p>可见，EM算法的结果与真实结果相同。</p>
</div>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 1 and 5 (page 204, Advanced R)</li>
<li>Excecises 1 and 7 (page 214, Advanced R)</li>
</ul>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercises-1-page-204-advanced-r" class="section level3">
<h3>Exercises 1 (page 204, Advanced R)</h3>
<p>Why are the following two invocations of lapply() equivalent?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.127382
## 
## [[2]]
## [1] 0.05010048
## 
## [[3]]
## [1] 0.04571294
## 
## [[4]]
## [1] 0.1398861</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.127382
## 
## [[2]]
## [1] 0.05010048
## 
## [[3]]
## [1] 0.04571294
## 
## [[4]]
## [1] 0.1398861</code></pre>
<p>The first use an anonymous function varies the amount of trimming applied when computing the mean of a fixed x. The second doesn’t use FUN NAME instead of FUN.</p>
</div>
<div id="exercises-5-page-204-advanced-r" class="section level3">
<h3>Exercises 5 (page 204, Advanced R)</h3>
<p>For each model in the previous two exercises, extract R2 using the function below.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercises 3 </span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data =</span> mtcars)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models, rsq)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>r2</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercises 4</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, data)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps,linear_model)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models, rsq)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>r2</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7131941
## 
## [[2]]
## [1] 0.8032951
## 
## [[3]]
## [1] 0.8170228
## 
## [[4]]
## [1] 0.6159823
## 
## [[5]]
## [1] 0.8036888
## 
## [[6]]
## [1] 0.7901014
## 
## [[7]]
## [1] 0.7749131
## 
## [[8]]
## [1] 0.7131563
## 
## [[9]]
## [1] 0.6410638
## 
## [[10]]
## [1] 0.7425413</code></pre>
</div>
<div id="excecises-1-page-214-advanced-r" class="section level3">
<h3>Excecises 1 (page 214, Advanced R)</h3>
<p>Use vapply() to:</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol></li>
</ul>
<p>使用sd函数计算数值型dataframe每一列标准差</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a)</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>numeric.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(numeric.df, sd, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##       X1       X2       X3       X4       X5       X6 
## 2.973961 2.710064 3.025815 2.319004 3.142893 2.626785</code></pre>
<p>使用R中的CO2数据，前3列为字符型，后两列为数值型，先用is.numeric函数判断是否为数值型，在对数值型的列使用sd函数计算列标准差</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CO2)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>( CO2[ <span class="fu">vapply</span>(CO2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>)) ], sd, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##      conc    uptake 
## 295.92412  10.81441</code></pre>
</div>
<div id="excecises-7-page-214-advanced-r" class="section level3">
<h3>Excecises 7 (page 214, Advanced R)</h3>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
<p>下面是mcsapply()的实现,由于使用windows，mclapply()不能进行并行计算，所以使用parLapply()函数。</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(x, f, ..., <span class="at">mc.cores=</span>1L) {</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># res &lt;- mclapply(x, f, ...,mc.cores = mc.cores) #this can be run in linux</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">4</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterExport</span>(cluster,<span class="st">&quot;pause&quot;</span>,<span class="at">envir =</span> <span class="fu">environment</span>())</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cluster, x, f, ...)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify2array</span>(res)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>可以实现mcvapply()，因为vapply与lapply一样，每个迭代都是与所有其他迭代隔离的，所以它们的计算顺序并不重要，能够并型计算。</p>
</div>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<ul>
<li>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</li>
<li>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</li>
<li>Campare the computation time of the two functions with the function “microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="exercise-9.8-page-278-statistical-computing-with-r" class="section level3">
<h3>Exercise 9.8 (page 278, Statistical Computing with R)</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1},\ x=0,1,\ldots,n,0 \le y \le 1.
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(<span class="math inline">\(n, y\)</span>) and Beta(<span class="math inline">\(x + a, n − x + b\)</span>). Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f (x, y)\)</span>.</p>
<p>Rcpp实现的代码如下</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>NumericMatrix <span class="fu">gibbsC</span>(double a,double b,double n){</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  int N <span class="ot">=</span> <span class="dv">10000</span>;</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  NumericMatrix <span class="fu">X</span>(N,<span class="dv">2</span>);</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="ot">=</span> <span class="dv">0</span>;</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="ot">=</span> <span class="fl">0.5</span>;</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  double X1, X2;</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i=</span><span class="dv">1</span>; i<span class="sc">&lt;</span>N; i<span class="sc">++</span>){</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">=</span> <span class="fu">X</span>(i<span class="dv">-1</span>,<span class="dv">1</span>);</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">0</span>) <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,X2)[<span class="dv">0</span>];</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">=</span> <span class="fu">X</span>(i,<span class="dv">0</span>);</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">1</span>) <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,n<span class="sc">-</span>X1<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  return X;</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="compare-the-corresponding-generated-random-numbers-with-pure-r-language-using-the-function-qqplot." class="section level3">
<h3>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</h3>
<p>R实现的9.8的代码如下</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">10000</span>          <span class="co">#样本量</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  <span class="co">#样本阵</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  X</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>cpp文件要与md文件在同一路径下。对R生成随机数于Cpp生成的随机数使用qqplot比较。x,y的qqplot都接近直线说明两个语言生成的随机数相似。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;./&#39;</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir_cpp,<span class="st">&quot;gibbsC.cpp&quot;</span>))</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">25</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>X.R <span class="ot">=</span> <span class="fu">gibbsR</span>(a,b,n)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>X.C <span class="ot">=</span> <span class="fu">gibbsC</span>(a,b,n)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X.R[,<span class="dv">1</span>],X.C[,<span class="dv">1</span>])</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X.R[,<span class="dv">2</span>],X.C[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="compare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark." class="section level3">
<h3>Compare the computation time of the two functions with the function “microbenchmark”.</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(a,b,n),<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(a,b,n))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<p>Cpp代码的运行时间要比R代码的时间快10倍左右。</p>
</div>
<div id="comments-your-results." class="section level3">
<h3>Comments your results.</h3>
<p>结果很明显，Cpp代码的生成的随机数与R代码生成的随机数性能相同，但cpp运行时间要比R的时间快上10倍。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
